

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pipeline.pipeline &mdash; XAI-Units 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="pipeline.results" href="../results/index.html" />
    <link rel="prev" title="pipeline.experiment" href="../experiment/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            XAI-Units
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../library_quickstart.html">Quickstart - Library Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../image_dataset_example.html">Image Dataset Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../custom_methods_and_custom_datasets.html">Customization Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../model/index.html">model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../methods/index.html">methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../metrics/index.html">metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../trainer/index.html">trainer</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">pipeline</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../experiment/index.html">pipeline.experiment</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">pipeline.pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../results/index.html">pipeline.results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#attributes">Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#package-contents">Package Contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../fine_tune/index.html">fine_tune</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../common_lib/index.html">common_lib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../datagenerator/index.html">datagenerator</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">XAI-Units</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../index.html">pipeline</a></li>
      <li class="breadcrumb-item active">pipeline.pipeline</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/autoapi/pipeline/pipeline/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pipeline.pipeline">
<span id="pipeline-pipeline"></span><h1>pipeline.pipeline<a class="headerlink" href="#module-pipeline.pipeline" title="Link to this heading"></a></h1>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.pipeline.methods" title="pipeline.pipeline.methods"><code class="xref py py-obj docutils literal notranslate"><span class="pre">methods</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.pipeline.BasePipeline" title="pipeline.pipeline.BasePipeline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePipeline</span></code></a></p></td>
<td><p>A base class for creating an end-to-end pipeline object that applies feature attribution methods and</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pipeline.pipeline.Pipeline" title="pipeline.pipeline.Pipeline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Pipeline</span></code></a></p></td>
<td><p>A pipeline that evaluates the performance of the explanation methods on the neural network models</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.pipeline.ExperimentPipeline" title="pipeline.pipeline.ExperimentPipeline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ExperimentPipeline</span></code></a></p></td>
<td><p>A pipeline that evaluates the performance of the explanation methods on the neural network models</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pipeline.pipeline.to_device" title="pipeline.pipeline.to_device"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_device</span></code></a>(→ Any)</p></td>
<td><p>Moves data to device if the data is a tensor or a dict of tensors.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pipeline.pipeline.</span></span><span class="sig-name descname"><span class="pre">BasePipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">xaiunits.pipeline.results.Results</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_examples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.pipeline.BasePipeline" title="Link to this definition"></a></dt>
<dd><p>A base class for creating an end-to-end pipeline object that applies feature attribution methods and
evaluates.</p>
<p>This is a base class is intended to support other pipeline classes that are build upon it.</p>
<p>Explanation methods to be ran and evaluated must contain the .attribute method.
The pipeline uses batching when applying the explanation methods and evaluating them over the evaluation metrics.
The results of the explanation method’s performance will be processed and cleaned by within the pipeline, and is
easily callable by the user. Non-deterministic explanation methods are accomodated too, where
multiple trials runs is possible with the pipeline.</p>
<p>Alongside evaluation performance, runtime performance is measured in the pipeline too. For
customisation of the explanation methods and evaluation metrics, applying a wrapper to them may
be necessary prior to inputing to the pipeline.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline.batch_size" title="Link to this definition"></a></dt>
<dd><p>Number of data samples to be processed by the models and for the explanation
methods to be applied on within each batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline.default_target">
<span class="sig-name descname"><span class="pre">default_target</span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline.default_target" title="Link to this definition"></a></dt>
<dd><p>Type or values of the target that is expected to be outputed by the
models.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline.n_examples">
<span class="sig-name descname"><span class="pre">n_examples</span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline.n_examples" title="Link to this definition"></a></dt>
<dd><p>Number of worst and best performing data samples stored based on evaluation
metric scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int | NoneType</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline.results">
<span class="sig-name descname"><span class="pre">results</span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline.results" title="Link to this definition"></a></dt>
<dd><p>Instance of Results for storing and processing the evaluation results.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../index.html#pipeline.Results" title="pipeline.Results">pipeline.Results</a> | NoneType</p>
</dd>
</dl>
</dd></dl>

<p>Initializes a BasePipeline object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – Number of data samples to be processed by the models and for the explanation
methods to be applied on within each batch. Defaults to 50.</p></li>
<li><p><strong>default_target</strong> (<em>Any</em><em>, </em><em>optional</em>) – Type or values of the target that is expected to be outputed by the
models. Defaults to None.</p></li>
<li><p><strong>n_examples</strong> (<em>int</em><em> | </em><em>NoneType</em><em>, </em><em>optional</em>) – Number of worst and best performing data samples stored based on evaluation
metric scores. Defaults to None.</p></li>
<li><p><strong>results</strong> (<a class="reference internal" href="../index.html#pipeline.Results" title="pipeline.Results"><em>pipeline.Results</em></a><em> | </em><em>NoneType</em>) – Instance of Results for storing and processing the evaluation results.
Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50</span></em><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">default_target</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">n_examples</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">results</span></span><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline._init_attr">
<span class="sig-name descname"><span class="pre">_init_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">collections.abc.Iterable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span></span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline._init_attr" title="Link to this definition"></a></dt>
<dd><p>Initializes the attributes by checking its type and converts it into a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>attr_input</strong> (<em>Iterable</em><em> | </em><em>NoneType</em><em> | </em><em>Any</em>) – The object or collection of objects
relevant to the attribute of interest.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing all the elements of the input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline._single_explanation_attribute">
<span class="sig-name descname"><span class="pre">_single_explanation_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_group_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline._single_explanation_attribute" title="Link to this definition"></a></dt>
<dd><p>Computes the score of a single explanation method on a neural network and
evaluates the explanation method with respect to all evaluation metrics.</p>
<p>The explanation method is applied over the dataset by batches, where the a
batch with size batch_size is generated by the dataset iteratively and the
attribution score for it is computed. Depending on the explanation method
the attribution score may be fixed or unfixed for each sample within the
same batch.</p>
<p>The total runtime of applying the explanation method to each batch will be
measured.</p>
<p>Evaluation metrics are similarly calculated individually for the attribution
score of each batch.</p>
<p>If the n_samples attribute is not None, the batches that give the best and
worst n_samples number of evaluation metric scores will be stored.</p>
<p>The evaluation and runtime measurements will be stored inside the results
attribute in batches as a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.util.data.Dataset</em>) – Dataset of inputs</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Neural network to for the explanation method
to be applied on</p></li>
<li><p><strong>method</strong> (<em>methods.methods_wrapper.Wrapper</em>) – Explanation method to be
applied to the model and evaluated.</p></li>
<li><p><strong>metrics</strong> (<em>list</em>) – List of evaluation metrics to be applied.</p></li>
<li><p><strong>method_seed</strong> (<em>int</em><em> | </em><em>NoneType</em><em>, </em><em>optional</em>) – The seed set for reproducibility of the
explanation method. It will not be set if it is None. Defaults to None.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device which the objects will be stored on.
Defaults to None.</p></li>
<li><p><strong>trial_group_name</strong> (<em>str</em>) – string representing name of the trial group name</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline._apply_attribution_method">
<span class="sig-name descname"><span class="pre">_apply_attribution_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_instance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline._apply_attribution_method" title="Link to this definition"></a></dt>
<dd><p>Computes the attribution evaluation for the given feature inputs using the explanation method of interest.</p>
<p>The time it takes to compute the feature attributions is appended to the results for the current
batch of data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_inputs</strong> (<em>torch.Tensor</em>) – The input features for the current batch.</p></li>
<li><p><strong>method_instance</strong> (<em>Any</em>) – Explanation method used to compute the feature attributions.</p></li>
<li><p><strong>batch_results</strong> (<em>dict</em>) – Recorded results for the current batch of data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed feature attributions for the given feature inputs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline._store_top_n">
<span class="sig-name descname"><span class="pre">_store_top_n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline._store_top_n" title="Link to this definition"></a></dt>
<dd><p>Keeps a running heap of the top n examples with the highest scores, for each key.</p>
<p>Supports both ‘max’ / ‘min’ example_type, for the n highest / lowest scores.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If <cite>batch_scores</cite> is a single value, it is repeated to match the batch size.</p></li>
<li><p>The heap of examples are stored in <cite>results.examples</cite>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of examples to store.</p></li>
<li><p><strong>key</strong> (<em>tuple</em>) – The key to identify which (method, model, metric) these examples are for.</p></li>
<li><p><strong>batch_scores</strong> (<em>torch.Tensor</em>) – A tensor of scores for the current batch of examples.</p></li>
<li><p><strong>attribute</strong> (<em>torch.Tensor</em>) – The attributes tensor for the current batch of examples.</p></li>
<li><p><strong>batch_info</strong> (<em>tuple</em>) – A tuple containing feature inputs, labels, targets, and context for the batch.</p></li>
<li><p><strong>example_type</strong> (<em>str</em>) – Specifies the type of scoring mechanism (‘max’ or ‘min’) to use for ranking.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline.unpack_batch">
<span class="sig-name descname"><span class="pre">unpack_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span></span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline.unpack_batch" title="Link to this definition"></a></dt>
<dd><p>Unpacks a batch into (feature_inputs, labels, context) depending on the format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>torch.Tensor</em><em> | </em><em>Tuple</em>) – A batch of data which can be a single tensor (feature_inputs),
a tuple of two tensors (feature_inputs and labels),
or a tuple of three elements (feature_inputs, labels, and context).</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device which the objects will be stored on.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If dataset is not in a supported format.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline.set_default_target">
<span class="sig-name descname"><span class="pre">set_default_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline.set_default_target" title="Link to this definition"></a></dt>
<dd><p>Calculates the target based on self.default_target.</p>
<p>Two special keywords:
- If self.default_target is ‘y_labels’, returns the y_labels
- If self.default_target is ‘predicted_class’, returns y=model(feature_inputs)</p>
<p>Three other standard options:
- If self.default_target is None, returns None.
- If self.default_target is an integer, returns that integer.
- self.target may also be a tuple or tensor matching the batch size.</p>
<p>These are the standard options that will be used by the default evaluation methods.
If an alternative option is needed, the user can override the evaluation metric function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model to use for predictions if <cite>self.default_target</cite> is ‘predicted_class’.</p></li>
<li><p><strong>feature_inputs</strong> (<em>torch.Tensor</em>) – The input features to the model.</p></li>
<li><p><strong>y_labels</strong> (<em>torch.Tensor</em>) – The actual labels for the input features, if <cite>self.default_target</cite> is ‘y_labels’</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the value of default_target is invalid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.BasePipeline._all_models_explanation_attributes">
<span class="sig-name descname"><span class="pre">_all_models_explanation_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">methods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_seeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_group_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#pipeline.pipeline.BasePipeline._all_models_explanation_attributes" title="Link to this definition"></a></dt>
<dd><p>Applies every explanation methods on each of the neural network models and
they are evaluated against the evalaution metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.utils.data.Dataset</em>) – Dataset the neural netowrk models are operating on.</p></li>
<li><p><strong>models</strong> (<em>list</em>) – List of neural network models for the explanation methods to be applied on.</p></li>
<li><p><strong>methods</strong> (<em>list</em>) – List of explanation methods to apply and evaluated.</p></li>
<li><p><strong>metrics</strong> (<em>list</em>) – List of evaluation metrics to apply.</p></li>
<li><p><strong>method_seeds</strong> (<em>list</em>) – List of random seeds for applying the explanation method.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device which the objects will be stored on.
Defaults to None.</p></li>
<li><p><strong>trial_group_name</strong> (<em>str</em>) – string representing name of the trial group name</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pipeline.pipeline.Pipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pipeline.pipeline.</span></span><span class="sig-name descname"><span class="pre">Pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">methods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_seeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">xaiunits.pipeline.results.Results</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_examples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.pipeline.Pipeline" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.pipeline.BasePipeline" title="pipeline.pipeline.BasePipeline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePipeline</span></code></a></p>
<p>A pipeline that evaluates the performance of the explanation methods on the neural network models
with respect to evaluation metrics of interest.</p>
<p>Single or multiple models, Single or multiple datasets, explanation methods, evaluation methods are supported.
Explanation methods must contain the .attribute method. The pipeline uses batching when applying the
explanation methods and evaluating them over the evaluation metrics. The results of the
explanation method’s performance will be processed and cleaned by within the pipeline, and is
easily callable by the user. Non-deterministic explanation methods are accomodated too, where
multiple trials runs is possible with the pipeline.</p>
<p>If no evaluation metric is provided explicitly as an argument to the instantiation of a Pipeline object,
then a default metric will be used from one of the provided datasets, subject to the availability of it
in any of the datasets.</p>
<p>Alongside evaluation performance, runtime performance is measured in the pipeline too. For
customization of the explanation methods and evaluation metrics, applying a wrapper to them may
be necessary prior to inputting to the pipeline.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>BasePipeline: Base class for setting up a pipeline that applies feature attribution methods and
evaluates.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.Pipeline.models">
<span class="sig-name descname"><span class="pre">models</span></span><a class="headerlink" href="#pipeline.pipeline.Pipeline.models" title="Link to this definition"></a></dt>
<dd><p>List of neural network models for the explanation methods to be applied on.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.Pipeline.datas">
<span class="sig-name descname"><span class="pre">datas</span></span><a class="headerlink" href="#pipeline.pipeline.Pipeline.datas" title="Link to this definition"></a></dt>
<dd><p>Dataset object for generating the data samples that are
compatible to the neural networks provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.Pipeline.methods">
<span class="sig-name descname"><span class="pre">methods</span></span><a class="headerlink" href="#pipeline.pipeline.Pipeline.methods" title="Link to this definition"></a></dt>
<dd><p>List of explanation methods to be evaluated for their performance
on producing attribution scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.Pipeline.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#pipeline.pipeline.Pipeline.metrics" title="Link to this definition"></a></dt>
<dd><p>List of evaluation metrics for the explanation methods to be evaluated
against.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.Pipeline.method_seed">
<span class="sig-name descname"><span class="pre">method_seed</span></span><a class="headerlink" href="#pipeline.pipeline.Pipeline.method_seed" title="Link to this definition"></a></dt>
<dd><p>List of seeds used for repeating and replicating the results over a single or
multiple trials.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<p>Initializes a Pipeline object.</p>
<p>All models, explanation methods, evaluation metrics, method seed inputs will be forced to be
list that contains all the relevant items. Labels for the evaluation metrics will be generated
based on methods.methods_wrapper.MetricsWrapper.__name__ and must be unique.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models</strong> (<em>torch.nn.Module</em><em> | </em><em>Iterable</em>) – Single or iterable collection of neural network models
for explanation methods to be applied on.</p></li>
<li><p><strong>data</strong> (<em>torch.utils.data.Dataset</em><em> | </em><em>Iterable</em>) – Dataset object for generating the data samples that are
compatible to the neural networks provided.</p></li>
<li><p><strong>methods</strong> (<em>methods.methods_wrapper.Wrapper</em><em> | </em><em>captum.attr._utils.attribution.Attribution</em><em> | </em><em>Iterable</em>) – Single or iterable collection of explanation methods to be evaluated.</p></li>
<li><p><strong>metrics</strong> (<em>methods.methods_wrapper.MetricsWrapper</em><em> | </em><em>Iterable</em><em> | </em><em>None</em>) – Single or iterable
collection of evaluation metrics used for evaluating explanation methods. Defaults to None.</p></li>
<li><p><strong>method_seed</strong> (<em>int</em><em> | </em><em>Iterable</em><em>, </em><em>optional</em>) – Seeds for replicating explanation methods results
over multiple trials. Defaults to None, and a random seed will be picked where no
replicability will be enforced.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Number of data samples to be processed by the models and for the explanation
methods to be applied on within each batch. Defaults to 50.</p></li>
<li><p><strong>default_target</strong> (<em>Any</em><em>, </em><em>optional</em>) – Type or values of the target that is expected to be outputted by the
models. Defaults to None.</p></li>
<li><p><strong>model_names</strong> (<em>str</em><em> | </em><em>Iterable</em><em>, </em><em>optional</em>) – Single or iterable collection of model name
used the purpose of distinguishing between models. Defaults to None.</p></li>
<li><p><strong>results</strong> (<a class="reference internal" href="../index.html#pipeline.Results" title="pipeline.Results"><em>Results</em></a><em>, </em><em>optional</em>) – Instance of Results for storing and processing the
evaluation results. Defaults to None, and an empty Results instance will be
used.</p></li>
<li><p><strong>n_examples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of worst and best performing data samples stored
based on evaluation metric scores. Defaults to None.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – string representing name of the trial group.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If the collection of evaluation metrics do not all have unique names.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">models</span></span><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">datas</span></span><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">methods</span></span><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">method_seed</span></span><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.Pipeline.trial_group_name">
<span class="sig-name descname"><span class="pre">trial_group_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pipeline.pipeline.Pipeline.trial_group_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.Pipeline.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">xaiunits.pipeline.results.Results</span></span></span><a class="headerlink" href="#pipeline.pipeline.Pipeline.run" title="Link to this definition"></a></dt>
<dd><p>Alias for explanation_attribute method. Runs the pipeline and returns the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device which the objects will be stored on.
Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the evaluation results from running the pipeline.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../index.html#pipeline.Results" title="pipeline.Results">pipeline.Results</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.Pipeline.explanation_attribute">
<span class="sig-name descname"><span class="pre">explanation_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">xaiunits.pipeline.results.Results</span></span></span><a class="headerlink" href="#pipeline.pipeline.Pipeline.explanation_attribute" title="Link to this definition"></a></dt>
<dd><p>Applies every explanation methods on each of the neural network models and
dataset, which are then evaluated against the evaluation metrics.</p>
<p>If an evaluation metric is not wrapped as a methods.methods_wrapper.Wrapper
instance, manual wrapping will be performed.</p>
<p>The explanation methods will be repeated a variable number of times depending
on the method_seed attribute.</p>
<p>All evaluation and runtime results will be stored within the results attribute
in its unprocessed form.</p>
<p>Each of the neural network models will be forced to evaluation mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device which the objects will be stored on.
Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the evaluation results from running the pipeline.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../index.html#pipeline.Results" title="pipeline.Results">pipeline.Results</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.Pipeline._init_none_metric">
<span class="sig-name descname"><span class="pre">_init_none_metric</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#pipeline.pipeline.Pipeline._init_none_metric" title="Link to this definition"></a></dt>
<dd><p>Returns the default metric from any of the dataset inputted, if available.</p>
<p>It iterates over the provided data and checks if any of them have a default
metric attribute. If a default metric is found, it returns that metric. Otherwise,
it raises an exception.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The class that wraps the default metric from one of the datasets inputed.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>type</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If none of the provided datasets have a default metric.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pipeline.pipeline.ExperimentPipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pipeline.pipeline.</span></span><span class="sig-name descname"><span class="pre">ExperimentPipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">xaiunits.pipeline.experiment.Experiment</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">xaiunits.pipeline.experiment.Experiment</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">xaiunits.pipeline.results.Results</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_examples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pipeline.pipeline.ExperimentPipeline" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pipeline.pipeline.BasePipeline" title="pipeline.pipeline.BasePipeline"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BasePipeline</span></code></a></p>
<p>A pipeline that evaluates the performance of the explanation methods on the neural network models
with respect to evaluation metrics of interest.</p>
<p>This pipeline only expects a list of Experiment Class, in which data, models, explanation methods,
evaluation metric and seeds are specified.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>BasePipeline: Base class for setting up a pipeline that applies feature attribution methods and
evaluates.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pipeline.pipeline.ExperimentPipeline.experiments">
<span class="sig-name descname"><span class="pre">experiments</span></span><a class="headerlink" href="#pipeline.pipeline.ExperimentPipeline.experiments" title="Link to this definition"></a></dt>
<dd><p>List experiments to be ran.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[<a class="reference internal" href="../index.html#pipeline.Experiment" title="pipeline.Experiment">pipeline.Experiment</a>]</p>
</dd>
</dl>
</dd></dl>

<p>Initializes an ExperimentPipeline object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiments</strong> (<em>List</em><em>[</em><a class="reference internal" href="../experiment/index.html#pipeline.experiment.Experiment" title="pipeline.experiment.Experiment"><em>Experiment</em></a><em>]</em>) – List of experiments to be run.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Number of data samples to be processed by the models and for the explanation
methods to be applied on within each batch. Defaults to 50.</p></li>
<li><p><strong>default_target</strong> (<em>Any</em><em>, </em><em>optional</em>) – Type or values of the target that is expected to be outputed by the
models. Defaults to None.</p></li>
<li><p><strong>results</strong> (<a class="reference internal" href="../index.html#pipeline.Results" title="pipeline.Results"><em>Results</em></a><em>, </em><em>optional</em>) – Instance of Results for storing and processing the
evaluation results. Defaults to None, and an empty Results instance will be
used.</p></li>
<li><p><strong>n_examples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of worst and best performing data samples stored
based on evaluation metric scores. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">experiments</span></span><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.ExperimentPipeline.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">xaiunits.pipeline.results.Results</span></span></span><a class="headerlink" href="#pipeline.pipeline.ExperimentPipeline.run" title="Link to this definition"></a></dt>
<dd><p>Alias for explanation_attribute method. Runs the pipeline and returns the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device which the objects will be stored on.
Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the evaluation results from running the pipeline.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../index.html#pipeline.Results" title="pipeline.Results">pipeline.Results</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pipeline.pipeline.ExperimentPipeline.explanation_attribute">
<span class="sig-name descname"><span class="pre">explanation_attribute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">xaiunits.pipeline.results.Results</span></span></span><a class="headerlink" href="#pipeline.pipeline.ExperimentPipeline.explanation_attribute" title="Link to this definition"></a></dt>
<dd><p>Using the items stored in each Experiment object, apply every explanation methods
on each of the neural network models, which are then evaluated against the evalaution
metrics.</p>
<p>Depending on the type of object that is given to represent the dataset, multiple
datasets will be instantiated using the various seeds provided, or simply using
the single dataset object supplied.</p>
<p>If an evaluation metric is not wrapped as a methods.methods_wrapper.Wrapper
instance, manual wrapping will be peformed.</p>
<p>The explanation methods will be repeated a variable number of times depending
on the method_seed attribute.</p>
<p>All evaluation and runtime results will be stored within the results attribute
in its unprocessed form.</p>
<p>Each of the neural network models will be forced to evaluation mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The device which the objects will be stored on.
Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the evaluation results from running the pipeline.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../index.html#pipeline.Results" title="pipeline.Results">pipeline.Results</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pipeline.pipeline.to_device">
<span class="sig-prename descclassname"><span class="pre">pipeline.pipeline.</span></span><span class="sig-name descname"><span class="pre">to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#pipeline.pipeline.to_device" title="Link to this definition"></a></dt>
<dd><p>Moves data to device if the data is a tensor or a dict of tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Any</em>) – Data to be moved.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – Device to move the data to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Data object that is stored in the specified device.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pipeline.pipeline.methods">
<span class="sig-prename descclassname"><span class="pre">pipeline.pipeline.</span></span><span class="sig-name descname"><span class="pre">methods</span></span><a class="headerlink" href="#pipeline.pipeline.methods" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../experiment/index.html" class="btn btn-neutral float-left" title="pipeline.experiment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../results/index.html" class="btn btn-neutral float-right" title="pipeline.results" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, XAI-Units.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>