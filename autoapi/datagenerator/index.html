

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>datagenerator &mdash; XAI-Units 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="datagenerator.backgrounds" href="backgrounds/index.html" />
    <link rel="prev" title="common_lib" href="../common_lib/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            XAI-Units
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../library_quickstart.html">Quickstart - Library Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../image_dataset_example.html">Image Dataset Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../custom_methods_and_custom_datasets.html">Customization Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../model/index.html">model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../methods/index.html">methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/index.html">metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trainer/index.html">trainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/index.html">pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fine_tune/index.html">fine_tune</a></li>
<li class="toctree-l2"><a class="reference internal" href="../common_lib/index.html">common_lib</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">datagenerator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backgrounds/index.html">datagenerator.backgrounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="boolean/index.html">datagenerator.boolean</a></li>
<li class="toctree-l4"><a class="reference internal" href="conflicting/index.html">datagenerator.conflicting</a></li>
<li class="toctree-l4"><a class="reference internal" href="data_generation/index.html">datagenerator.data_generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="foregrounds/index.html">datagenerator.foregrounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="image_generation/index.html">datagenerator.image_generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="interacting_features/index.html">datagenerator.interacting_features</a></li>
<li class="toctree-l4"><a class="reference internal" href="pertinent_negatives/index.html">datagenerator.pertinent_negatives</a></li>
<li class="toctree-l4"><a class="reference internal" href="shattered_grad/index.html">datagenerator.shattered_grad</a></li>
<li class="toctree-l4"><a class="reference internal" href="text_datasets/index.html">datagenerator.text_datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="uncertainty_aware/index.html">datagenerator.uncertainty_aware</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#attributes">Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#package-contents">Package Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.BaseFeaturesDataset"><code class="docutils literal notranslate"><span class="pre">BaseFeaturesDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.WeightedFeaturesDataset"><code class="docutils literal notranslate"><span class="pre">WeightedFeaturesDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.load_dataset"><code class="docutils literal notranslate"><span class="pre">load_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.generate_csv"><code class="docutils literal notranslate"><span class="pre">generate_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.data"><code class="docutils literal notranslate"><span class="pre">data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.BooleanAndDataset"><code class="docutils literal notranslate"><span class="pre">BooleanAndDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.BooleanDataset"><code class="docutils literal notranslate"><span class="pre">BooleanDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.BooleanOrDataset"><code class="docutils literal notranslate"><span class="pre">BooleanOrDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.ConflictingDataset"><code class="docutils literal notranslate"><span class="pre">ConflictingDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.BalancedImageDataset"><code class="docutils literal notranslate"><span class="pre">BalancedImageDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.ImbalancedImageDataset"><code class="docutils literal notranslate"><span class="pre">ImbalancedImageDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.ImageDataset"><code class="docutils literal notranslate"><span class="pre">ImageDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.InteractingFeatureDataset"><code class="docutils literal notranslate"><span class="pre">InteractingFeatureDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.PertinentNegativesDataset"><code class="docutils literal notranslate"><span class="pre">PertinentNegativesDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.ShatteredGradientsDataset"><code class="docutils literal notranslate"><span class="pre">ShatteredGradientsDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.UncertaintyAwareDataset"><code class="docutils literal notranslate"><span class="pre">UncertaintyAwareDataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#datagenerator.TextTriggerDataset"><code class="docutils literal notranslate"><span class="pre">TextTriggerDataset</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">XAI-Units</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">API Reference</a></li>
      <li class="breadcrumb-item active">datagenerator</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/autoapi/datagenerator/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-datagenerator">
<span id="datagenerator"></span><h1>datagenerator<a class="headerlink" href="#module-datagenerator" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="backgrounds/index.html">datagenerator.backgrounds</a></li>
<li class="toctree-l1"><a class="reference internal" href="boolean/index.html">datagenerator.boolean</a></li>
<li class="toctree-l1"><a class="reference internal" href="conflicting/index.html">datagenerator.conflicting</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_generation/index.html">datagenerator.data_generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="foregrounds/index.html">datagenerator.foregrounds</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_generation/index.html">datagenerator.image_generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="interacting_features/index.html">datagenerator.interacting_features</a></li>
<li class="toctree-l1"><a class="reference internal" href="pertinent_negatives/index.html">datagenerator.pertinent_negatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="shattered_grad/index.html">datagenerator.shattered_grad</a></li>
<li class="toctree-l1"><a class="reference internal" href="text_datasets/index.html">datagenerator.text_datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="uncertainty_aware/index.html">datagenerator.uncertainty_aware</a></li>
</ul>
</div>
</section>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#datagenerator.data" title="datagenerator.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#datagenerator.BaseFeaturesDataset" title="datagenerator.BaseFeaturesDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseFeaturesDataset</span></code></a></p></td>
<td><p>Generic synthetic dataset of continuous features for AI explainability.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#datagenerator.WeightedFeaturesDataset" title="datagenerator.WeightedFeaturesDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WeightedFeaturesDataset</span></code></a></p></td>
<td><p>A class extending BaseFeaturesDataset with support for weighted features.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#datagenerator.BooleanAndDataset" title="datagenerator.BooleanAndDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BooleanAndDataset</span></code></a></p></td>
<td><p>Generic synthetic dataset based on a propositional formula.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#datagenerator.BooleanDataset" title="datagenerator.BooleanDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BooleanDataset</span></code></a></p></td>
<td><p>Generic synthetic dataset based on a propositional formula.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#datagenerator.BooleanOrDataset" title="datagenerator.BooleanOrDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BooleanOrDataset</span></code></a></p></td>
<td><p>Generic synthetic dataset based on a propositional formula.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#datagenerator.ConflictingDataset" title="datagenerator.ConflictingDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConflictingDataset</span></code></a></p></td>
<td><p>Generic synthetic dataset with feature cancellation capabilities.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#datagenerator.BalancedImageDataset" title="datagenerator.BalancedImageDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BalancedImageDataset</span></code></a></p></td>
<td><p>A dataset for images where each each image consists of a background and a foreground overlay.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#datagenerator.ImbalancedImageDataset" title="datagenerator.ImbalancedImageDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImbalancedImageDataset</span></code></a></p></td>
<td><p>Creates Image Dataset where each image comprises of a background image an a foreground image.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#datagenerator.ImageDataset" title="datagenerator.ImageDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImageDataset</span></code></a></p></td>
<td><p>A dataset for images with specified configurations for image generation, supporting both balanced and imbalanced datasets.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#datagenerator.InteractingFeatureDataset" title="datagenerator.InteractingFeatureDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InteractingFeatureDataset</span></code></a></p></td>
<td><p>A dataset subclass for modeling interactions between categorical and continuous features within weighted datasets.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#datagenerator.PertinentNegativesDataset" title="datagenerator.PertinentNegativesDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PertinentNegativesDataset</span></code></a></p></td>
<td><p>A dataset designed to investigate the impact of pertinent negative (PN) features</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#datagenerator.ShatteredGradientsDataset" title="datagenerator.ShatteredGradientsDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ShatteredGradientsDataset</span></code></a></p></td>
<td><p>A class intended to generate data and weights that exhibit shattered gradient phenomena.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#datagenerator.UncertaintyAwareDataset" title="datagenerator.UncertaintyAwareDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">UncertaintyAwareDataset</span></code></a></p></td>
<td><p>A dataset designed to investigate how feature attribution methods treat inputs</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#datagenerator.TextTriggerDataset" title="datagenerator.TextTriggerDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TextTriggerDataset</span></code></a></p></td>
<td><p>A PyTorch Dataset for text data with trigger words and feature masks, designed for explainable AI (XAI) tasks.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#datagenerator.load_dataset" title="datagenerator.load_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_dataset</span></code></a>() → Optional[Union[BaseFeaturesDataset, ...)</p></td>
<td><p>Loads a previously saved dataset from a binary pickle file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#datagenerator.generate_csv" title="datagenerator.generate_csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_csv</span></code></a>(→ None)</p></td>
<td><p>Generates a CSV file with random data for a specified number of rows and features.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">BaseFeaturesDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.distributions.Distribution</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.Dataset</span></code></p>
<p>Generic synthetic dataset of continuous features for AI explainability.</p>
<p>This class creates a dataset of continuous features based on a specified distribution,
which can be used for training and evaluating AI models. It allows for reproducible
sample creation, customizable features and sample sizes, and supports various distributions.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.seed" title="Link to this definition"></a></dt>
<dd><p>Seed for random number generators to ensure reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.n_features">
<span class="sig-name descname"><span class="pre">n_features</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.n_features" title="Link to this definition"></a></dt>
<dd><p>Number of features in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.n_samples">
<span class="sig-name descname"><span class="pre">n_samples</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.n_samples" title="Link to this definition"></a></dt>
<dd><p>Number of samples in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.distribution">
<span class="sig-name descname"><span class="pre">distribution</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.distribution" title="Link to this definition"></a></dt>
<dd><p>Distribution used for generating the samples.
Defaults to ‘normal’ which uses a multivariate normal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | torch.distributions.Distribution</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.sample_std_dev">
<span class="sig-name descname"><span class="pre">sample_std_dev</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.sample_std_dev" title="Link to this definition"></a></dt>
<dd><p>Standard deviation of the noise added to the samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.label_std_dev">
<span class="sig-name descname"><span class="pre">label_std_dev</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.label_std_dev" title="Link to this definition"></a></dt>
<dd><p>Standard deviation of the noise added to generate labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.samples">
<span class="sig-name descname"><span class="pre">samples</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.samples" title="Link to this definition"></a></dt>
<dd><p>Generated samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.labels">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.labels" title="Link to this definition"></a></dt>
<dd><p>Generated labels with optional noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.ground_truth_attribute">
<span class="sig-name descname"><span class="pre">ground_truth_attribute</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.ground_truth_attribute" title="Link to this definition"></a></dt>
<dd><p>Name of the attribute considered as ground truth.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.subset_data">
<span class="sig-name descname"><span class="pre">subset_data</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.subset_data" title="Link to this definition"></a></dt>
<dd><p>List of attributes to be included in subsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.subset_attribute">
<span class="sig-name descname"><span class="pre">subset_attribute</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.subset_attribute" title="Link to this definition"></a></dt>
<dd><p>Additional attributes to be considered in subsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.cat_features">
<span class="sig-name descname"><span class="pre">cat_features</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.cat_features" title="Link to this definition"></a></dt>
<dd><p>List of categorical feature names, used in perturbations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<p>Initializes a dataset of continuous features based on a specified distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – For sample creation reproducibility. Defaults to 0.</p></li>
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features for each sample. Defaults to 2.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Total number of samples. Defaults to 10.</p></li>
<li><p><strong>distribution</strong> (<em>str</em><em> | </em><em>torch.distributions.Distribution</em>) – Distribution to use for generating samples.
Defaults to “normal”, which indicates multivariate normal distribution.</p></li>
<li><p><strong>distribution_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for the distribution if a string identifier
is used. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – <p>Arbitrary keyword arguments, including:</p>
<ul>
<li><p>sample_std_dev (float): Standard deviation for sample creation noise. Defaults to 1.</p></li>
<li><p>label_std_dev (float): Noise standard deviation to generate labels. Defaults to 0.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If an unsupported string identifier is provided.</p></li>
<li><p><strong>TypeError</strong> – If ‘distribution’ is neither a string nor a torch.distributions.Distribution instance.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.label_noise">
<span class="sig-name descname"><span class="pre">label_noise</span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.label_noise" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.features">
<span class="sig-name descname"><span class="pre">features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'samples'</span></em><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">ground_truth_attribute</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'samples'</span></em><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">subset_data</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['samples']</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">subset_attribute</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['perturb_function',</span> <span class="pre">'name']</span></em><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">cat_features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'BaseFeaturesDataset'</span></em><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.__len__" title="Link to this definition"></a></dt>
<dd><p>Returns the total number of samples in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Total number of samples.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['ground_truth_attribute']</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Retrieves a sample and its label, along with optional attributes, by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index of the sample to retrieve.</p></li>
<li><p><strong>others</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Additional attributes to be retrieved with the sample and label.
Defaults to [“ground_truth_attribute”].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the sample and label at the specified index,</dt><dd><p>and optionally, a dictionary of additional attributes if requested.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>IndexError</strong> – If the specified index is out of the bounds of the dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_lengths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[0.7,</span> <span class="pre">0.3]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#datagenerator.BaseFeaturesDataset" title="datagenerator.BaseFeaturesDataset"><span class="pre">BaseFeaturesDataset</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#datagenerator.BaseFeaturesDataset" title="datagenerator.BaseFeaturesDataset"><span class="pre">BaseFeaturesDataset</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.split" title="Link to this definition"></a></dt>
<dd><p>Splits the dataset into subsets based on specified proportions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>split_lengths</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Proportions to split the dataset into. The values
must sum up to 1. Defaults to [0.7, 0.3] for a 70%/30% split.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the split subsets</dt><dd><p>of the dataset.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[<a class="reference internal" href="#datagenerator.BaseFeaturesDataset" title="datagenerator.BaseFeaturesDataset">BaseFeaturesDataset</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.save_dataset">
<span class="sig-name descname"><span class="pre">save_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">os.getcwd()</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.save_dataset" title="Link to this definition"></a></dt>
<dd><p>Saves the dataset to a pickle file in the specified directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>str</em>) – Name of the file to save the dataset.</p></li>
<li><p><strong>directory_path</strong> (<em>str</em>) – Path to the directory where the file will be saved.
Defaults to the current working directory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset._validate_inputs">
<span class="sig-name descname"><span class="pre">_validate_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset._validate_inputs" title="Link to this definition"></a></dt>
<dd><p>Validates the input parameters for dataset initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Seed for random number generation.</p></li>
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validated seed and number of features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[int, int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any input is not an integer or is out of an expected range.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset._init_noise_parameters">
<span class="sig-name descname"><span class="pre">_init_noise_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset._init_noise_parameters" title="Link to this definition"></a></dt>
<dd><p>Initializes noise parameters from keyword arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Keyword arguments passed to the initializer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initialized sample and label standard deviations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the standard deviations are not positive numbers.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset._init_samples">
<span class="sig-name descname"><span class="pre">_init_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.distributions.Distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.distributions.Distribution</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset._init_samples" title="Link to this definition"></a></dt>
<dd><p>Initializes samples based on the specified distribution and sample size.</p>
<p>This method supports initialization using either a predefined distribution name (string) or directly
with a torch.distributions.Distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples to generate, must be positive.</p></li>
<li><p><strong>distribution</strong> (<em>str</em><em> | </em><em>torch.distributions.Distribution</em>) – The distribution to use for
generating samples. Can be a string for predefined distributions (‘normal’, ‘uniform’, ‘poisson’)
or an instance of torch.distributions.Distribution.</p></li>
<li><p><strong>distribution_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for the distribution if a string identifier
is used. Examples:
- For ‘normal’: {‘mean’: torch.zeros(n_features), ‘stddev’: torch.ones(n_features)}
- For ‘uniform’: {‘low’: -1.0, ‘high’: 1.0}
- For ‘poisson’: {‘rate’: 3.0}</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing generated samples (torch.Tensor) with shape [n_samples, n_features]</dt><dd><p>and the distribution instance used.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If ‘distribution’ is a string and is not one of the supported identifiers or
necessary parameters are missing.</p></li>
<li><p><strong>TypeError</strong> – If ‘distribution’ is neither a string identifier nor a torch.distributions.Distribution instance,
or if the provided Distribution instance cannot generate a torch.Tensor.</p></li>
<li><p><strong>RuntimeError</strong> – If the generated samples do not match the expected shape and cannot be adjusted.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.perturb_function">
<span class="sig-name descname"><span class="pre">perturb_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_resample_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_infidelity_decorator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multipy_by_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.perturb_function" title="Link to this definition"></a></dt>
<dd><p>Generates perturb function to be used for feature attribution method evaluation. Applies Gaussian noise
for continuous features, and resampling for categorical features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise_scale</strong> (<em>float</em>) – A standard deviation of the Gaussian noise added to the continuous features.
Defaults to 0.01.</p></li>
<li><p><strong>cat_resample_prob</strong> (<em>float</em>) – Probability of resampling a categorical feature. Defaults to 0.2.</p></li>
<li><p><strong>run_infidelity_decorator</strong> (<em>bool</em>) – Set to True if you want the returned fns to be compatible with infidelity.
Set flag to False for sensitivity. Defaults to True.</p></li>
<li><p><strong>multiply_by_inputs</strong> (<em>bool</em>) – Parameters for decorator. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A perturbation function compatible with Captum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>perturb_func (function)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.generate_model">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.generate_model" title="Link to this definition"></a></dt>
<dd><p>Generates a corresponding model for current dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the method is not implemented by a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="datagenerator.BaseFeaturesDataset.default_metric">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#datagenerator.BaseFeaturesDataset.default_metric" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Abstractmethod<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>The default metric for evaluating the performance of explanation methods applied
to this dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – If the property is not implemented by a subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">WeightedFeaturesDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.distributions.Distribution</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-1.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#datagenerator.BaseFeaturesDataset" title="datagenerator.BaseFeaturesDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseFeaturesDataset</span></code></a></p>
<p>A class extending BaseFeaturesDataset with support for weighted features.</p>
<p>This class allows for creating a synthetic dataset with continuous features,
where each feature can be weighted differently. This is particularly useful for
scenarios where the impact of different features on the labels needs to be
artificially manipulated or studied.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>BaseFeaturesDataset: The base class for creating continuous feature datasets.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.weights">
<span class="sig-name descname"><span class="pre">weights</span></span><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.weights" title="Link to this definition"></a></dt>
<dd><p>Weights applied to each feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.weight_range">
<span class="sig-name descname"><span class="pre">weight_range</span></span><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.weight_range" title="Link to this definition"></a></dt>
<dd><p>The range (min, max) within which random weights are generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.weighted_samples">
<span class="sig-name descname"><span class="pre">weighted_samples</span></span><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.weighted_samples" title="Link to this definition"></a></dt>
<dd><p>The samples after applying weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<p>Initializes a WeightedFeaturesDataset object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Seed for reproducibility. Defaults to 0.</p></li>
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features. Defaults to 2.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples. Defaults to 10.</p></li>
<li><p><strong>distribution</strong> (<em>str</em>) – Type of distribution to use for generating samples. Defaults to “normal”.</p></li>
<li><p><strong>weight_range</strong> (<em>tuple</em>) – Range (min, max) for generating random weights. Defaults to (-1.0, 1.0).</p></li>
<li><p><strong>weights</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Specific weights for each feature.
If None, weights are generated randomly within <cite>weight_range</cite>. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – <p>Arbitrary keyword arguments passed to the base class constructor, including:</p>
<ul>
<li><p>sample_std_dev (float): Standard deviation for sample creation noise. Defaults to 1.</p></li>
<li><p>label_std_dev (float): Noise standard deviation to generate labels. Defaults to 0.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">weighted_samples</span></span><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.label_noise">
<span class="sig-name descname"><span class="pre">label_noise</span></span><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.label_noise" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.labels">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.labels" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.features">
<span class="sig-name descname"><span class="pre">features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'samples'</span></em><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.ground_truth_attribute">
<span class="sig-name descname"><span class="pre">ground_truth_attribute</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'weighted_samples'</span></em><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.ground_truth_attribute" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.subset_data">
<span class="sig-name descname"><span class="pre">subset_data</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['samples',</span> <span class="pre">'weighted_samples']</span></em><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.subset_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.subset_attribute">
<span class="sig-name descname"><span class="pre">subset_attribute</span></span><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.subset_attribute" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset._initialize_weights">
<span class="sig-name descname"><span class="pre">_initialize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset._initialize_weights" title="Link to this definition"></a></dt>
<dd><p>Initializes or validates the weights for each feature.</p>
<p>If weights are not provided, they are randomly generated within the specified range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>torch.Tensor</em><em> | </em><em>NoneType</em>) – If provided, these weights are used directly for the features.
Must be a Tensor with a length equal to <cite>n_features</cite>.</p></li>
<li><p><strong>weight_range</strong> (<em>tuple</em>) – Specifies the minimum and maximum values used to generate weights if <cite>weights</cite> is None.
Expected format: (min_value, max_value), where both are floats.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The validated or generated weights and the effective weight range used.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[torch.Tensor, tuple]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – If the provided weights do not match the number of features or are not a torch.Tensor when provided.</p></li>
<li><p><strong>ValueError</strong> – If <cite>weight_range</cite> is improperly specified.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.generate_model">
<span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.generate_model" title="Link to this definition"></a></dt>
<dd><p>Generates and returns a neural network model configured to use the weighted features of this dataset.</p>
<p>The model is designed to reflect the differential impact of each feature as specified by the weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A neural network model that includes mechanisms to account for feature weights,</dt><dd><p>suitable for tasks requiring understanding of feature importance.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../model/index.html#model.ContinuousFeaturesNN" title="model.ContinuousFeaturesNN">model.ContinuousFeaturesNN</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="datagenerator.WeightedFeaturesDataset.default_metric">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#datagenerator.WeightedFeaturesDataset.default_metric" title="Link to this definition"></a></dt>
<dd><p>The default metric for evaluating the performance of explanation methods applied
to this dataset.</p>
<p>For this dataset, the default metric is the Mean Squared Error (MSE) loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A class that wraps around the default metric to be instantiated</dt><dd><p>within the pipeline.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>type</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datagenerator.load_dataset">
<span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">load_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">os.getcwd()</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#datagenerator.BaseFeaturesDataset" title="datagenerator.BaseFeaturesDataset"><span class="pre">BaseFeaturesDataset</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#datagenerator.WeightedFeaturesDataset" title="datagenerator.WeightedFeaturesDataset"><span class="pre">WeightedFeaturesDataset</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.load_dataset" title="Link to this definition"></a></dt>
<dd><p>Loads a previously saved dataset from a binary pickle file.</p>
<p>This function is designed to retrieve datasets that have been saved to disk, facilitating
easy sharing and reloading of data for analysis or model training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – The name of the file to load.</p></li>
<li><p><strong>directory_path</strong> (<em>str</em>) – The directory where the file is located. Defaults to the current working directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded dataset object, or None, if the file does not exist or an error occurs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object | NoneType</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datagenerator.generate_csv">
<span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">generate_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.generate_csv" title="Link to this definition"></a></dt>
<dd><p>Generates a CSV file with random data for a specified number of rows and features.</p>
<p>This function helps create synthetic datasets for testing or development purposes.
Each row will have a random label and a specified number of features filled with random values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_label</strong> (<em>str</em>) – The base name for the CSV file.</p></li>
<li><p><strong>num_rows</strong> (<em>int</em>) – Number of rows (samples) to generate. Defaults to 5000.</p></li>
<li><p><strong>num_features</strong> – Number of features to generate for each sample. Defaults to 20.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="datagenerator.data">
<span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#datagenerator.data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">BooleanAndDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.BooleanAndDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#datagenerator.BooleanDataset" title="datagenerator.BooleanDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BooleanDataset</span></code></a></p>
<p>Generic synthetic dataset based on a propositional formula.</p>
<p>The dataset corresponds to sampling rows from the truth table of the given propositional
formula. If n_samples is no larger than the size of the truth table, then the generated
dataset will always contain non-duplicate samples of the truth table. Otherwise,
the dataset will still contain rows for the entire truth table but will also contain
duplicates.</p>
<p>If the input for atoms is None, the corresponding attribute is by default assigned
as the atoms that are extracted from the given formula.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>BaseFeaturesDataset: The base class for creating continuous feature datasets.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.formula">
<span class="sig-name descname"><span class="pre">formula</span></span><a class="headerlink" href="#datagenerator.BooleanAndDataset.formula" title="Link to this definition"></a></dt>
<dd><p>A propositional formula for which the dataset
is generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sympy.core.function.FunctionClass</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.atoms">
<span class="sig-name descname"><span class="pre">atoms</span></span><a class="headerlink" href="#datagenerator.BooleanAndDataset.atoms" title="Link to this definition"></a></dt>
<dd><p>The ordered collection of propositional atoms that were used within the
propositional formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#datagenerator.BooleanAndDataset.seed" title="Link to this definition"></a></dt>
<dd><p>Seed for random number generators to ensure reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.n_samples">
<span class="sig-name descname"><span class="pre">n_samples</span></span><a class="headerlink" href="#datagenerator.BooleanAndDataset.n_samples" title="Link to this definition"></a></dt>
<dd><p>Number of samples in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initializes a BooleanDataset object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>formula</strong> (<em>sympy.core.function.FunctionClass</em>) – A propositional formula for dataset generation.</p></li>
<li><p><strong>atoms</strong> (<em>Iterable</em><em>, </em><em>optional</em>) – Ordered collection of propositional atoms used in the formula.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed for random number generation, ensuring reproducibility. Defaults to 0.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples to generate for the dataset. Defaults to 10.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.n_features">
<span class="sig-name descname"><span class="pre">n_features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#datagenerator.BooleanAndDataset.n_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.ground_truth">
<span class="sig-name descname"><span class="pre">ground_truth</span></span><a class="headerlink" href="#datagenerator.BooleanAndDataset.ground_truth" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.ground_truth_attribute">
<span class="sig-name descname"><span class="pre">ground_truth_attribute</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ground_truth'</span></em><a class="headerlink" href="#datagenerator.BooleanAndDataset.ground_truth_attribute" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.create_baselines">
<span class="sig-name descname"><span class="pre">create_baselines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.BooleanAndDataset.create_baselines" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['baseline',</span> <span class="pre">'ground_truth_attribute']</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.BooleanAndDataset.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Retrieve a sample and its associated label by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index of the sample to retrieve.</p></li>
<li><p><strong>others</strong> (<em>list</em>) – Additional items to retrieve. Defaults to [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the sample and its label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.generate_model">
<span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="headerlink" href="#datagenerator.BooleanAndDataset.generate_model" title="Link to this definition"></a></dt>
<dd><p>Generates a neural network model using the given propositional formula and atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A neural network model tailored to the dataset’s propositional formula.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../model/index.html#model.PropFormulaNN" title="model.PropFormulaNN">model.PropFormulaNN</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.create_ground_truth">
<span class="sig-name descname"><span class="pre">create_ground_truth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#datagenerator.BooleanAndDataset.create_ground_truth" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="datagenerator.BooleanAndDataset.default_metric">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#datagenerator.BooleanAndDataset.default_metric" title="Link to this definition"></a></dt>
<dd><p>The default metric for evaluating the performance of explanation methods applied
to this dataset.</p>
<p>For this dataset, the default metric is the infidelity metric with the
default perturb function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A class that wraps around the default metric to be instantiated</dt><dd><p>within the pipeline.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>type</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">BooleanDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sympy.core.function.FunctionClass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.BooleanDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">xaiunits.datagenerator.data_generation.BaseFeaturesDataset</span></code></p>
<p>Generic synthetic dataset based on a propositional formula.</p>
<p>The dataset corresponds to sampling rows from the truth table of the given propositional
formula. If n_samples is no larger than the size of the truth table, then the generated
dataset will always contain non-duplicate samples of the truth table. Otherwise,
the dataset will still contain rows for the entire truth table but will also contain
duplicates.</p>
<p>If the input for atoms is None, the corresponding attribute is by default assigned
as the atoms that are extracted from the given formula.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>BaseFeaturesDataset: The base class for creating continuous feature datasets.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.formula">
<span class="sig-name descname"><span class="pre">formula</span></span><a class="headerlink" href="#datagenerator.BooleanDataset.formula" title="Link to this definition"></a></dt>
<dd><p>A propositional formula for which the dataset
is generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sympy.core.function.FunctionClass</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.atoms">
<span class="sig-name descname"><span class="pre">atoms</span></span><a class="headerlink" href="#datagenerator.BooleanDataset.atoms" title="Link to this definition"></a></dt>
<dd><p>The ordered collection of propositional atoms that were used within the
propositional formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#datagenerator.BooleanDataset.seed" title="Link to this definition"></a></dt>
<dd><p>Seed for random number generators to ensure reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.n_samples">
<span class="sig-name descname"><span class="pre">n_samples</span></span><a class="headerlink" href="#datagenerator.BooleanDataset.n_samples" title="Link to this definition"></a></dt>
<dd><p>Number of samples in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initializes a BooleanDataset object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>formula</strong> (<em>sympy.core.function.FunctionClass</em>) – A propositional formula for dataset generation.</p></li>
<li><p><strong>atoms</strong> (<em>Iterable</em><em>, </em><em>optional</em>) – Ordered collection of propositional atoms used in the formula.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed for random number generation, ensuring reproducibility. Defaults to 0.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples to generate for the dataset. Defaults to 10.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">atoms</span></span><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">formula</span></span><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.subset_data">
<span class="sig-name descname"><span class="pre">subset_data</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['samples']</span></em><a class="headerlink" href="#datagenerator.BooleanDataset.subset_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.subset_attribute">
<span class="sig-name descname"><span class="pre">subset_attribute</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['perturb_function',</span> <span class="pre">'default_metric',</span> <span class="pre">'generate_model',</span> <span class="pre">'name']</span></em><a class="headerlink" href="#datagenerator.BooleanDataset.subset_attribute" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.cat_features">
<span class="sig-name descname"><span class="pre">cat_features</span></span><a class="headerlink" href="#datagenerator.BooleanDataset.cat_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'BooleanDataset'</span></em><a class="headerlink" href="#datagenerator.BooleanDataset.name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset._initialize_samples_labels">
<span class="sig-name descname"><span class="pre">_initialize_samples_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.BooleanDataset._initialize_samples_labels" title="Link to this definition"></a></dt>
<dd><p>Initializes the samples and labels of the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_samples</strong> (<em>int</em>) – number of samples/labels contained in the dataset.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple containing the generated samples</dt><dd><p>and corresponding labels of the dataset.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.perturb_function">
<span class="sig-name descname"><span class="pre">perturb_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cat_resample_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_infidelity_decorator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multipy_by_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="headerlink" href="#datagenerator.BooleanDataset.perturb_function" title="Link to this definition"></a></dt>
<dd><p>Generates perturb function to be used for XAI method evaluation. Applies gaussian noise
for continuous features, and resampling for categorical features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cat_resample_prob</strong> (<em>float</em>) – Probability of resampling a categorical feature. Defaults to 0.2.</p></li>
<li><p><strong>run_infidelity_decorator</strong> (<em>bool</em>) – Set to true if the returned fns is to be compatible with
infidelity. Set flag to False for sensitivity. Defaults to True.</p></li>
<li><p><strong>multiply_by_inputs</strong> (<em>bool</em>) – Parameters for decorator. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A perturbation function compatible with Captum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>perturb_func (function)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.generate_model">
<span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="headerlink" href="#datagenerator.BooleanDataset.generate_model" title="Link to this definition"></a></dt>
<dd><p>Generates a neural network model using the given propositional formula and atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A neural network model tailored to the dataset’s propositional formula.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../model/index.html#model.PropFormulaNN" title="model.PropFormulaNN">model.PropFormulaNN</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.default_metric">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#datagenerator.BooleanDataset.default_metric" title="Link to this definition"></a></dt>
<dd><p>The default metric for evaluating the performance of explanation methods applied
to this dataset.</p>
<p>For this dataset, the default metric is the infidelity metric with the
default perturb function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A class that wraps around the default metric to be instantiated</dt><dd><p>within the pipeline.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanDataset.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.BooleanDataset.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Retrieve a sample and its associated label by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index of the sample to retrieve.</p></li>
<li><p><strong>others</strong> (<em>list</em>) – Additional items to retrieve. Defaults to [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the sample and its label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">BooleanOrDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.BooleanOrDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#datagenerator.BooleanDataset" title="datagenerator.BooleanDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BooleanDataset</span></code></a></p>
<p>Generic synthetic dataset based on a propositional formula.</p>
<p>The dataset corresponds to sampling rows from the truth table of the given propositional
formula. If n_samples is no larger than the size of the truth table, then the generated
dataset will always contain non-duplicate samples of the truth table. Otherwise,
the dataset will still contain rows for the entire truth table but will also contain
duplicates.</p>
<p>If the input for atoms is None, the corresponding attribute is by default assigned
as the atoms that are extracted from the given formula.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>BaseFeaturesDataset: The base class for creating continuous feature datasets.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.formula">
<span class="sig-name descname"><span class="pre">formula</span></span><a class="headerlink" href="#datagenerator.BooleanOrDataset.formula" title="Link to this definition"></a></dt>
<dd><p>A propositional formula for which the dataset
is generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sympy.core.function.FunctionClass</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.atoms">
<span class="sig-name descname"><span class="pre">atoms</span></span><a class="headerlink" href="#datagenerator.BooleanOrDataset.atoms" title="Link to this definition"></a></dt>
<dd><p>The ordered collection of propositional atoms that were used within the
propositional formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#datagenerator.BooleanOrDataset.seed" title="Link to this definition"></a></dt>
<dd><p>Seed for random number generators to ensure reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.n_samples">
<span class="sig-name descname"><span class="pre">n_samples</span></span><a class="headerlink" href="#datagenerator.BooleanOrDataset.n_samples" title="Link to this definition"></a></dt>
<dd><p>Number of samples in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Initializes a BooleanDataset object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>formula</strong> (<em>sympy.core.function.FunctionClass</em>) – A propositional formula for dataset generation.</p></li>
<li><p><strong>atoms</strong> (<em>Iterable</em><em>, </em><em>optional</em>) – Ordered collection of propositional atoms used in the formula.
Defaults to None.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed for random number generation, ensuring reproducibility. Defaults to 0.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples to generate for the dataset. Defaults to 10.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.n_features">
<span class="sig-name descname"><span class="pre">n_features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#datagenerator.BooleanOrDataset.n_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.ground_truth">
<span class="sig-name descname"><span class="pre">ground_truth</span></span><a class="headerlink" href="#datagenerator.BooleanOrDataset.ground_truth" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.ground_truth_attribute">
<span class="sig-name descname"><span class="pre">ground_truth_attribute</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ground_truth'</span></em><a class="headerlink" href="#datagenerator.BooleanOrDataset.ground_truth_attribute" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.create_baselines">
<span class="sig-name descname"><span class="pre">create_baselines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.BooleanOrDataset.create_baselines" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['baseline',</span> <span class="pre">'ground_truth_attribute']</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.BooleanOrDataset.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Retrieve a sample and its associated label by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index of the sample to retrieve.</p></li>
<li><p><strong>others</strong> (<em>list</em>) – Additional items to retrieve. Defaults to [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the sample and its label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.generate_model">
<span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="headerlink" href="#datagenerator.BooleanOrDataset.generate_model" title="Link to this definition"></a></dt>
<dd><p>Generates a neural network model using the given propositional formula and atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A neural network model tailored to the dataset’s propositional formula.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../model/index.html#model.PropFormulaNN" title="model.PropFormulaNN">model.PropFormulaNN</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.create_ground_truth">
<span class="sig-name descname"><span class="pre">create_ground_truth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#datagenerator.BooleanOrDataset.create_ground_truth" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="datagenerator.BooleanOrDataset.default_metric">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#datagenerator.BooleanOrDataset.default_metric" title="Link to this definition"></a></dt>
<dd><p>The default metric for evaluating the performance of explanation methods applied
to this dataset.</p>
<p>For this dataset, the default metric is the infidelity metric with the
default perturb function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A class that wraps around the default metric to be instantiated</dt><dd><p>within the pipeline.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>type</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">ConflictingDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-1.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cancellation_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cancellation_likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.ConflictingDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">xaiunits.datagenerator.WeightedFeaturesDataset</span></code></p>
<p>Generic synthetic dataset with feature cancellation capabilities.</p>
<p>Feature cancellations are based on likelihood. If cancellation_features are not provided,
all features in each sample are candidates for cancellation, with a specified likelihood of
each feature being canceled. Canceled features are negated in their contributions to the dataset,
allowing for the analysis of model behavior under feature absence scenarios.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>WeightedFeaturesDataset: Class extending BaseFeaturesDataset with support for weighted features</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.cancellation_features">
<span class="sig-name descname"><span class="pre">cancellation_features</span></span><a class="headerlink" href="#datagenerator.ConflictingDataset.cancellation_features" title="Link to this definition"></a></dt>
<dd><p>Indices of features subject to cancellation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.cancellation_likelihood">
<span class="sig-name descname"><span class="pre">cancellation_likelihood</span></span><a class="headerlink" href="#datagenerator.ConflictingDataset.cancellation_likelihood" title="Link to this definition"></a></dt>
<dd><p>Likelihood of feature cancellation, between 0 and 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.cancellation_outcomes">
<span class="sig-name descname"><span class="pre">cancellation_outcomes</span></span><a class="headerlink" href="#datagenerator.ConflictingDataset.cancellation_outcomes" title="Link to this definition"></a></dt>
<dd><p>Binary tensor indicating whether each feature in each sample is canceled.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.cancellation_samples">
<span class="sig-name descname"><span class="pre">cancellation_samples</span></span><a class="headerlink" href="#datagenerator.ConflictingDataset.cancellation_samples" title="Link to this definition"></a></dt>
<dd><p>Concatenation of samples with their cancellation outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.cancellation_attributions">
<span class="sig-name descname"><span class="pre">cancellation_attributions</span></span><a class="headerlink" href="#datagenerator.ConflictingDataset.cancellation_attributions" title="Link to this definition"></a></dt>
<dd><p>The attribution of each feature considering the cancellation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.cat_features">
<span class="sig-name descname"><span class="pre">cat_features</span></span><a class="headerlink" href="#datagenerator.ConflictingDataset.cat_features" title="Link to this definition"></a></dt>
<dd><p>Categorical features derived from the cancellation samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.ground_truth_attributions">
<span class="sig-name descname"><span class="pre">ground_truth_attributions</span></span><a class="headerlink" href="#datagenerator.ConflictingDataset.ground_truth_attributions" title="Link to this definition"></a></dt>
<dd><p>Combined tensor of weighted samples and cancellation attributions for ground truth analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<p>Initializes a ConflictingDataset object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Seed for random number generation, ensuring reproducibility. Defaults to 0.</p></li>
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features in each sample. Defaults to 2.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples to generate. Defaults to 10.</p></li>
<li><p><strong>distribution</strong> (<em>str</em>) – Type of distribution to use for generating samples. Defaults to ‘normal’.</p></li>
<li><p><strong>weight_range</strong> (<em>tuple</em><em>[</em><em>float</em><em>]</em>) – Range (min, max) for generating random feature weights. Defaults to (-1.0, 1.0).</p></li>
<li><p><strong>weights</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Predefined weights for each feature. Defaults to None.</p></li>
<li><p><strong>cancellation_features</strong> (<em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Specific features to apply cancellations to.
Defaults to None, applying to all features.</p></li>
<li><p><strong>cancellation_likelihood</strong> (<em>float</em>) – Probability of each feature being canceled. Defaults to 0.5.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">cancellation_features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">cancellation_likelihood</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">cancellation_outcomes</span></span><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">cancellation_samples</span></span><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.labels">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#datagenerator.ConflictingDataset.labels" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">cancellation_attributions</span></span><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">cat_features</span></span><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">ground_truth_attributions</span></span><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.features">
<span class="sig-name descname"><span class="pre">features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'cancellation_samples'</span></em><a class="headerlink" href="#datagenerator.ConflictingDataset.features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.ground_truth_attribute">
<span class="sig-name descname"><span class="pre">ground_truth_attribute</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ground_truth_attributions'</span></em><a class="headerlink" href="#datagenerator.ConflictingDataset.ground_truth_attribute" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.subset_data">
<span class="sig-name descname"><span class="pre">subset_data</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['weighted_samples',</span> <span class="pre">'cancellation_outcomes',</span> <span class="pre">'cancellation_samples',...</span></em><a class="headerlink" href="#datagenerator.ConflictingDataset.subset_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset._initialize_cancellation_features">
<span class="sig-name descname"><span class="pre">_initialize_cancellation_features</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.ConflictingDataset._initialize_cancellation_features" title="Link to this definition"></a></dt>
<dd><p>Validates and initializes the list of features subject to cancellation. If no specific features
are provided, all features are considered candidates for cancellation.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> – If cancellation_features is not a list, any element in cancellation_features is not an integer,
the maximum element in cancellation_features is greater than the number of features, or cancellation_features
is empty. Also, if cancellation_likelihood is not a float or is outside the range [0, 1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset._get_cancellations">
<span class="sig-name descname"><span class="pre">_get_cancellations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#datagenerator.ConflictingDataset._get_cancellations" title="Link to this definition"></a></dt>
<dd><p>Generates a binary mask indicating whether each feature in each sample is canceled
based on the specified likelihood.</p>
<p>This method considers only the features specified in cancellation_features for possible cancellation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>An integer tensor of shape (n_samples, n_features) where 1 represents a canceled feature,</dt><dd><p>and 0 represents an active feature.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset._get_cancellation_samples">
<span class="sig-name descname"><span class="pre">_get_cancellation_samples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#datagenerator.ConflictingDataset._get_cancellation_samples" title="Link to this definition"></a></dt>
<dd><p>Concatenates the original samples with their cancellation outcomes to form a comprehensive dataset.</p>
<p>This allows for analyzing the impact of feature cancellations directly alongside the original features.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tensor containing the original samples augmented with their corresponding cancellation outcomes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset._get_cancellation_attributions">
<span class="sig-name descname"><span class="pre">_get_cancellation_attributions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#datagenerator.ConflictingDataset._get_cancellation_attributions" title="Link to this definition"></a></dt>
<dd><p>Computes the attribution of each feature by negating the effect of canceled features.</p>
<p>This method helps understand the impact of each feature on the model output when certain features are
systematically canceled.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A tensor of the same shape as the weighted samples, where the values of canceled features are</dt><dd><p>negated to reflect their absence.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ConflictingDataset.generate_model">
<span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="headerlink" href="#datagenerator.ConflictingDataset.generate_model" title="Link to this definition"></a></dt>
<dd><p>Instantiates and returns a neural network model for analyzing datasets with conflicting features.</p>
<p>The model is configured to use the specified features and weights, allowing for experimentation
with feature cancellations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A neural network model designed to work with the specified features and weights.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../model/index.html#model.ConflictingFeaturesNN" title="model.ConflictingFeaturesNN">model.ConflictingFeaturesNN</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.BalancedImageDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">BalancedImageDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.BalancedImageDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#datagenerator.ImageDataset" title="datagenerator.ImageDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImageDataset</span></code></a></p>
<p>A dataset for images where each each image consists of a background and a foreground overlay.</p>
<p>This ‘balanced’ dataset ensures that each combination of background (bg), foreground (fg), and foreground color (fg_color)
appears the same number of times across the dataset, making it ideal for machine learning models that benefit from
uniform exposure to all feature combinations.</p>
<p>Inherits all parameters from ImageDataset, and introduces no additional parameters, but it overrides the behavior
to ensure balance in the dataset composition.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>ImageDataset: Standard dataset that contains images with backgorunds and foregrounds.</p>
</dd>
</dl>
<p>Initializes a BalancedImageDataset with the same parameters as ImageDataset, ensuring each combination
of background, foreground, and color appears uniformly across the dataset.</p>
<p>After initialization, it automatically generates the samples and shuffles them if the ‘shuffled’ attribute is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – Additional arguments passed to the superclass initializer.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to the superclass initializer.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.BalancedImageDataset.generate_samples">
<span class="sig-name descname"><span class="pre">generate_samples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.BalancedImageDataset.generate_samples" title="Link to this definition"></a></dt>
<dd><p>Generates a balanced set of image samples by uniformly distributing each combination of background,
foreground shape, and color.</p>
<p>Iterates over each background, each shape, and each color to create the specified number of variants per combination.
Each generated image is stored in the ‘samples’ list, with corresponding labels in ‘labels’, and other metadata
like foreground shapes, background labels, and foreground colors stored in their respective lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If there is an issue with image generation parameters or overlay combinations.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.ImbalancedImageDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">ImbalancedImageDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backgrounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_variants</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imbalance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.ImbalancedImageDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#datagenerator.ImageDataset" title="datagenerator.ImageDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImageDataset</span></code></a></p>
<p>Creates Image Dataset where each image comprises of a background image an a foreground image.</p>
<p>Background images, type of foreground, color of foreground as well as other parameters can be specified.</p>
<p>Imbalance refers to the fact users can specify the percentage of dominant (bg, fg) pair vs other pair.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>ImageDataset: Standard dataset that contains images with backgorunds and foregrounds.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImbalancedImageDataset.imbalance">
<span class="sig-name descname"><span class="pre">imbalance</span></span><a class="headerlink" href="#datagenerator.ImbalancedImageDataset.imbalance" title="Link to this definition"></a></dt>
<dd><p>The proportion of samples that should favor a particular background per shape.
Should be within the range (0.0 to 1.0) inclusive.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<p>Initializes an ImbalancedImageDataset object with specified parameters, focusing on creating dataset variations
based on an imbalance parameter that dictates the dominance of certain shape-background pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backgrounds</strong> (<em>int</em><em> | </em><em>list</em>) – The number or list of specific background filenames. Defaults to 5.</p></li>
<li><p><strong>shapes</strong> (<em>int</em><em> | </em><em>list</em>) – The number or list of specific shapes. Defaults to 3.</p></li>
<li><p><strong>n_variants</strong> (<em>int</em>) – Number of variations per shape-background combination, affects dataset size.
Defaults to 100.</p></li>
<li><p><strong>shape_colors</strong> (<em>str</em><em> | </em><em>tuple</em>) – The default color for all shapes in the dataset. Defaults to ‘red’.</p></li>
<li><p><strong>imbalance</strong> (<em>float</em>) – The proportion (0.0 to 1.0) of samples that should favor a particular background per shape.
Defaults to 0.8.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to the superclass initializer.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">imbalance</span></span><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImbalancedImageDataset._prepare_shape_color">
<span class="sig-name descname"><span class="pre">_prepare_shape_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape_colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.ImbalancedImageDataset._prepare_shape_color" title="Link to this definition"></a></dt>
<dd><p>Prepares a single shape color based on the input.</p>
<p>Selects a random color if None is provided, validates a provided color string or RGBA tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape_colors</strong> (<em>str</em><em> | </em><em>tuple</em><em> | </em><em>NoneType</em>) – A specific color name, RGBA tuple, or None to select a random color.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing a single validated RGBA tuple representing the color.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the input is invalid or if the color name is not found in the predefined color dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImbalancedImageDataset._validate_imbalance">
<span class="sig-name descname"><span class="pre">_validate_imbalance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imbalance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#datagenerator.ImbalancedImageDataset._validate_imbalance" title="Link to this definition"></a></dt>
<dd><p>Validates that the imbalance parameter is a float between 0.0 and 1.0 inclusive, or None.</p>
<p>Ensures that the dataset can properly reflect the desired level of imbalance, adjusting for the
number of variants and available backgrounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>imbalance</strong> (<em>float</em><em> | </em><em>NoneType</em>) – The imbalance value to validate. If None is given as input, then
the argument will be treated as 0.3.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The validated imbalance value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the imbalance is not within the inclusive range [0.0, 1.0] or if the imbalance
settings are not feasible with the current settings of n_variants and backgrounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImbalancedImageDataset.generate_samples">
<span class="sig-name descname"><span class="pre">generate_samples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.ImbalancedImageDataset.generate_samples" title="Link to this definition"></a></dt>
<dd><p>Generates a set of image samples with overlay shapes or dinosaurs on backgrounds, considering imbalance.</p>
<dl class="simple">
<dt>Depending on the ‘imbalance’ parameter, this method either:</dt><dd><ul class="simple">
<li><p>Allocates a specific fraction (defined by ‘imbalance’) of the samples for each shape to a particular background,
with the remainder distributed among the other backgrounds.</p></li>
<li><p>Assigns all samples for a shape to a single background (imbalance = 1.0).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.ImageDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">ImageDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backgrounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_variants</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(512,</span> <span class="pre">512)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'geometric'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape_colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contour_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'local'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.ImageDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.Dataset</span></code></p>
<p>A dataset for images with specified configurations for image generation, supporting both balanced and imbalanced datasets.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>torch.utils.data.Dataset: The standard base class for defining a dataset within the PyTorch framework.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#datagenerator.ImageDataset.seed" title="Link to this definition"></a></dt>
<dd><p>Seed for random number generation to ensure reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.backgrounds">
<span class="sig-name descname"><span class="pre">backgrounds</span></span><a class="headerlink" href="#datagenerator.ImageDataset.backgrounds" title="Link to this definition"></a></dt>
<dd><p>List of background images to use for dataset generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.shapes">
<span class="sig-name descname"><span class="pre">shapes</span></span><a class="headerlink" href="#datagenerator.ImageDataset.shapes" title="Link to this definition"></a></dt>
<dd><p>List of shapes to overlay on background images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.n_variants">
<span class="sig-name descname"><span class="pre">n_variants</span></span><a class="headerlink" href="#datagenerator.ImageDataset.n_variants" title="Link to this definition"></a></dt>
<dd><p>Number of variations per shape-background combination, affects dataset size.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.background_size">
<span class="sig-name descname"><span class="pre">background_size</span></span><a class="headerlink" href="#datagenerator.ImageDataset.background_size" title="Link to this definition"></a></dt>
<dd><p>Dimensions (width, height) of background images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.shape_type">
<span class="sig-name descname"><span class="pre">shape_type</span></span><a class="headerlink" href="#datagenerator.ImageDataset.shape_type" title="Link to this definition"></a></dt>
<dd><p>Type of shapes: ‘geometric’ for geometric shapes, ‘dinosaurs’ for dinosaur shapes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.position">
<span class="sig-name descname"><span class="pre">position</span></span><a class="headerlink" href="#datagenerator.ImageDataset.position" title="Link to this definition"></a></dt>
<dd><p>Overlay position on the background (‘center’ or ‘random’).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.overlay_scale">
<span class="sig-name descname"><span class="pre">overlay_scale</span></span><a class="headerlink" href="#datagenerator.ImageDataset.overlay_scale" title="Link to this definition"></a></dt>
<dd><p>Scale factor for overlay relative to the background size.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.rotation">
<span class="sig-name descname"><span class="pre">rotation</span></span><a class="headerlink" href="#datagenerator.ImageDataset.rotation" title="Link to this definition"></a></dt>
<dd><p>If True, applies random rotation to overlays.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.shape_colors">
<span class="sig-name descname"><span class="pre">shape_colors</span></span><a class="headerlink" href="#datagenerator.ImageDataset.shape_colors" title="Link to this definition"></a></dt>
<dd><p>List of default color(s) for shapes, accepts color names or RGBA tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.shuffled">
<span class="sig-name descname"><span class="pre">shuffled</span></span><a class="headerlink" href="#datagenerator.ImageDataset.shuffled" title="Link to this definition"></a></dt>
<dd><p>If True, shuffles the dataset after generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><a class="headerlink" href="#datagenerator.ImageDataset.transform" title="Link to this definition"></a></dt>
<dd><p>Transformation function to apply to each image, typically converting to tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.contour_thickness">
<span class="sig-name descname"><span class="pre">contour_thickness</span></span><a class="headerlink" href="#datagenerator.ImageDataset.contour_thickness" title="Link to this definition"></a></dt>
<dd><p>Thickness of lines the contours are drawn with.
If it is negative, the contour interiors are drawn.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.image_builder">
<span class="sig-name descname"><span class="pre">image_builder</span></span><a class="headerlink" href="#datagenerator.ImageDataset.image_builder" title="Link to this definition"></a></dt>
<dd><p>Instance of ImageBuilder for generating images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="image_generation/index.html#datagenerator.image_generation.ImageBuilder" title="datagenerator.image_generation.ImageBuilder">ImageBuilder</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.samples">
<span class="sig-name descname"><span class="pre">samples</span></span><a class="headerlink" href="#datagenerator.ImageDataset.samples" title="Link to this definition"></a></dt>
<dd><p>List to store the generated samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.labels">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#datagenerator.ImageDataset.labels" title="Link to this definition"></a></dt>
<dd><p>List to store the labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.fg_shapes">
<span class="sig-name descname"><span class="pre">fg_shapes</span></span><a class="headerlink" href="#datagenerator.ImageDataset.fg_shapes" title="Link to this definition"></a></dt>
<dd><p>List to store the foreground shapes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.bg_labels">
<span class="sig-name descname"><span class="pre">bg_labels</span></span><a class="headerlink" href="#datagenerator.ImageDataset.bg_labels" title="Link to this definition"></a></dt>
<dd><p>List to store the background labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.fg_colors">
<span class="sig-name descname"><span class="pre">fg_colors</span></span><a class="headerlink" href="#datagenerator.ImageDataset.fg_colors" title="Link to this definition"></a></dt>
<dd><p>List to store the foreground colors.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.ground_truth">
<span class="sig-name descname"><span class="pre">ground_truth</span></span><a class="headerlink" href="#datagenerator.ImageDataset.ground_truth" title="Link to this definition"></a></dt>
<dd><p>List to store the ground truths.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<p>Initializes an ImageDataset object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Seed for random number generation to ensure reproducibility. Defaults to 0.</p></li>
<li><p><strong>backgrounds</strong> (<em>int</em><em> | </em><em>list</em>) – Number or list of specific backgrounds to use. Defaults to 5.</p></li>
<li><p><strong>shapes</strong> (<em>int</em><em> | </em><em>list</em>) – Number or list of specific shapes. Defaults to 10.</p></li>
<li><p><strong>n_variants</strong> (<em>int</em>) – Number of variations per shape-background combination, affects dataset size.
Defaults to 4.</p></li>
<li><p><strong>background_size</strong> (<em>tuple</em>) – Dimensions (width, height) of background images. Defaults to (512, 512).</p></li>
<li><p><strong>shape_type</strong> (<em>str</em>) – ‘geometric’ for geometric shapes, ‘dinosaurs’ for dinosaur shapes.
Defaults to ‘geometric’.</p></li>
<li><p><strong>position</strong> (<em>str</em>) – Overlay position on the background (‘center’ or ‘random’). Defaults to ‘random’.</p></li>
<li><p><strong>overlay_scale</strong> (<em>float</em>) – Scale factor for overlay relative to the background size. Defaults to 0.3.</p></li>
<li><p><strong>rotation</strong> (<em>bool</em>) – If True, applies random rotation to overlays. Defaults to False.</p></li>
<li><p><strong>shape_colors</strong> (<em>str</em><em> | </em><em>tuple</em><em>, </em><em>optional</em>) – Default color(s) for shapes, accepts color names or RGBA tuples.
Defaults to None.</p></li>
<li><p><strong>shuffled</strong> (<em>bool</em>) – If True, shuffles the dataset after generation. Defaults to True.</p></li>
<li><p><strong>transform</strong> (<em>callable</em><em>, </em><em>optional</em>) – Transformation function to apply to each image, typically converting to tensor.
Defaults to None.</p></li>
<li><p><strong>contour_thickness</strong> (<em>int</em>) – Defaults to 3.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">n_variants</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">image_builder</span></span><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">backgrounds</span></span><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">shapes</span></span><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">shape_colors</span></span><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">transform</span></span><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">samples</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">labels</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">fg_shapes</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#id25" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">bg_labels</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#id26" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id27">
<span class="sig-name descname"><span class="pre">fg_colors</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#id27" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id28">
<span class="sig-name descname"><span class="pre">ground_truth</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#id28" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id29">
<span class="sig-name descname"><span class="pre">shuffled</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#id29" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id30">
<span class="sig-name descname"><span class="pre">contour_thickness</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#id30" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImageDataset._validate_n_variants">
<span class="sig-name descname"><span class="pre">_validate_n_variants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_variants</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#datagenerator.ImageDataset._validate_n_variants" title="Link to this definition"></a></dt>
<dd><p>Validates that the number of variants per shape-background combination is a positive integer.</p>
<p>The <cite>n_variants</cite> parameter controls how many different versions of each shape-background combination are generated,
varying elements such as position and possibly color if specified. This allows for diverse training data in image
recognition tasks, improving the model’s ability to generalize from different perspectives and conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_variants</strong> (<em>int</em>) – The number of variations per shape-background combination to generate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The validated number of variants.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>n_variants</cite> is not an integer or is less than or equal to zero.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImageDataset._prepare_shapes">
<span class="sig-name descname"><span class="pre">_prepare_shapes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.ImageDataset._prepare_shapes" title="Link to this definition"></a></dt>
<dd><p>Prepares a list of shapes or dinosaurs based on the input and the specified shape type.</p>
<p>This method processes the input to generate a list of specific shapes or dinosaur names.
If a numerical input is provided, it selects that many random shapes/dinosaurs from the
available names. If a list is provided, it directly uses those specific names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape_type</strong> (<em>str</em>) – Specifies the type of overlay image, either ‘geometric’ or ‘dinosaurs’.</p></li>
<li><p><strong>shapes</strong> (<em>int</em><em> | </em><em>list</em>) – Number or list of specific shape names. If an integer is provided,
it indicates how many random shapes or dinosaurs to select.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of shape names or dinosaur names to be used as overlays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the shapes input is neither an integer nor a list, or if the shape_type is
not recognized as ‘geometric’ or ‘dinosaurs’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImageDataset._prepare_backgrounds">
<span class="sig-name descname"><span class="pre">_prepare_backgrounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backgrounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.ImageDataset._prepare_backgrounds" title="Link to this definition"></a></dt>
<dd><p>Prepares background images based on the input.</p>
<p>This method helps to either randomly select a set number of background images from the available
pool or validate and use a provided list of specific background filenames.</p>
<p>If a numerical value is provided, selects that many random backgrounds. If a list is provided,
validates and uses those specific backgrounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>backgrounds</strong> (<em>int</em><em> | </em><em>list</em>) – Number of random backgrounds to select or a list of specific background filenames.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of background filenames to be used in the dataset.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the input is neither an integer nor a list, or if any specified background filename
is not found in the available backgrounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImageDataset._prepare_shape_color">
<span class="sig-name descname"><span class="pre">_prepare_shape_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape_colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.ImageDataset._prepare_shape_color" title="Link to this definition"></a></dt>
<dd><p>Prepares shape colors by validating input against available colors.</p>
<p>If no valid colors are provided, a default color is selected. Accepts single or multiple colors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape_colors</strong> (<em>int</em><em> | </em><em>str</em><em> | </em><em>tuple</em><em> | </em><em>list</em>) – Specifies how many random colors to select or provides specific color(s).
Can be a single color name, RGBA tuple, or list of names/tuples.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of validated RGBA tuples representing the colors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If input is invalid or colors are not found in the available color dictionary.
Details about the invalid input are provided in the error message.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.generate_samples">
<span class="sig-name descname"><span class="pre">generate_samples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.ImageDataset.generate_samples" title="Link to this definition"></a></dt>
<dd><p>Placeholder method for generating the samples either for balanced or imbalanced datasets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.shuffle_dataset">
<span class="sig-name descname"><span class="pre">shuffle_dataset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.ImageDataset.shuffle_dataset" title="Link to this definition"></a></dt>
<dd><p>Randomly shuffles the dataset samples and corresponding labels to ensure variety
in training and evaluation phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the dataset is empty and shuffling is not possible.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#datagenerator.ImageDataset.__len__" title="Link to this definition"></a></dt>
<dd><p>Returns thet number of samples in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of samples contained by the dataset.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PIL.Image.Image</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.ImageDataset.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Retrieves an image and its label by index.</p>
<p>The image is transformed into a tensor if a transform is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – Index of the sample to retrieve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the transformed image tensor, label, a dict of other attributes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImageDataset._re_label">
<span class="sig-name descname"><span class="pre">_re_label</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.ImageDataset._re_label" title="Link to this definition"></a></dt>
<dd><p>Re-labels the dataset labels with integer indices.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.show_image">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">show_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.ImageDataset.show_image" title="Link to this definition"></a></dt>
<dd><p>Displays an image given its tensor representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img_tensor</strong> (<em>torch.Tensor</em>) – The image tensor to display.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="datagenerator.ImageDataset.default_metric">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#datagenerator.ImageDataset.default_metric" title="Link to this definition"></a></dt>
<dd><p>The default metric for evaluating the performance of explanation methods applied
to this dataset.</p>
<p>For this dataset, the default metric is the mask ratio metric that is constructed
based on the ground truth and context. Mask ratio is defined as the ratio of absolute
attribution score that lies within the foreground and the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A class that wraps around the default metric to be instantiated</dt><dd><p>within the pipeline.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>type</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">InteractingFeatureDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-1.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interacting_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[[1,</span> <span class="pre">0],</span> <span class="pre">[3,</span> <span class="pre">2]]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">xaiunits.datagenerator.WeightedFeaturesDataset</span></code></p>
<p>A dataset subclass for modeling interactions between categorical and continuous features within weighted datasets.</p>
<p>This class extends WeightedFeaturesDataset to support scenarios where the influence of one feature on the model
is conditional on the value of another, typically categorical, feature. For instance, the model may include terms like
<cite>w_i(x_j) * x_i + w_j * x_j</cite>, where the weight <cite>w_i(x_j)</cite> changes based on the value of <cite>x_j</cite>.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>WeightedFeaturesDataset: Class extending BaseFeaturesDataset with support for weighted features</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.interacting_features">
<span class="sig-name descname"><span class="pre">interacting_features</span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.interacting_features" title="Link to this definition"></a></dt>
<dd><p>Pairs of indices where the first index is the feature whose
weight is influenced by the second, categorical feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[list[int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.zero_likelihood">
<span class="sig-name descname"><span class="pre">zero_likelihood</span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.zero_likelihood" title="Link to this definition"></a></dt>
<dd><p>The likelihood of the categorical feature being zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.seed" title="Link to this definition"></a></dt>
<dd><p>Random seed for reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.n_features">
<span class="sig-name descname"><span class="pre">n_features</span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.n_features" title="Link to this definition"></a></dt>
<dd><p>Number of features in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.n_samples">
<span class="sig-name descname"><span class="pre">n_samples</span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.n_samples" title="Link to this definition"></a></dt>
<dd><p>Number of samples in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.weight_range">
<span class="sig-name descname"><span class="pre">weight_range</span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.weight_range" title="Link to this definition"></a></dt>
<dd><p>Min and max values for generating weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.weights">
<span class="sig-name descname"><span class="pre">weights</span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.weights" title="Link to this definition"></a></dt>
<dd><p>Initial weight values for features.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list | NoneType</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.subset_attribute">
<span class="sig-name descname"><span class="pre">subset_attribute</span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.subset_attribute" title="Link to this definition"></a></dt>
<dd><p>List of attributes that define the subset of the data with specific characteristics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id31">
<span class="sig-name descname"><span class="pre">interacting_features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[1,</span> <span class="pre">0],</span> <span class="pre">[3,</span> <span class="pre">2]]</span></em><a class="headerlink" href="#id31" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id32">
<span class="sig-name descname"><span class="pre">zero_likelihood</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#id32" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id33">
<span class="sig-name descname"><span class="pre">subset_attribute</span></span><a class="headerlink" href="#id33" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.cat_features">
<span class="sig-name descname"><span class="pre">cat_features</span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.cat_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.make_cat">
<span class="sig-name descname"><span class="pre">make_cat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.make_cat" title="Link to this definition"></a></dt>
<dd><p>Modifies the dataset to incorporate the specified categorical-to-continuous feature interactions.</p>
<p>The method ensures that the dataset is correctly modified to reflect the specified feature
interactions and their impact on weights and samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset._get_flat_weights">
<span class="sig-name descname"><span class="pre">_get_flat_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset._get_flat_weights" title="Link to this definition"></a></dt>
<dd><p>Convert the weights into a flat tensor.</p>
<p>This method takes a list of weights, which can be tuples representing ranges,
and converts them into a flat tensor. If the input weights are None, the method returns None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>weights</strong> (<em>list</em><em> | </em><em>NoneType</em>) – List of weights or None if weights are not specified.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flat tensor of weights if weights are provided, else None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor | NoneType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.InteractingFeatureDataset.generate_model">
<span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="headerlink" href="#datagenerator.InteractingFeatureDataset.generate_model" title="Link to this definition"></a></dt>
<dd><p>Generates a neural network model for interacting features analysis.</p>
<p>This method instantiates and returns a neural network model specifically designed
for analyzing datasets with interacting features. The model is configured using the
specified number of features, feature weights, and interacting features information.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>An instance of the InteractingFeaturesNN class, representing</dt><dd><p>the neural network model designed for interacting features analysis.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../model/index.html#model.InteractingFeaturesNN" title="model.InteractingFeaturesNN">model.InteractingFeaturesNN</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">PertinentNegativesDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-1.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pn_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pn_zero_likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pn_weight_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'zero'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">xaiunits.datagenerator.WeightedFeaturesDataset</span></code></p>
<p>A dataset designed to investigate the impact of pertinent negative (PN) features
on model predictions by introducing zero values in selected features, which are
expected to significantly impact the output.</p>
<p>This dataset is useful for scenarios where the absence of certain features
(indicated by zero values) provides important information for model predictions.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>WeightedFeaturesDataset: Class extending BaseFeaturesDataset with support for weighted features</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.pn_features">
<span class="sig-name descname"><span class="pre">pn_features</span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.pn_features" title="Link to this definition"></a></dt>
<dd><p>Indices of features considered as pertinent negatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.pn_zero_likelihood">
<span class="sig-name descname"><span class="pre">pn_zero_likelihood</span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.pn_zero_likelihood" title="Link to this definition"></a></dt>
<dd><p>Likelihood of a pertinent negative feature being set to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.pn_weight_factor">
<span class="sig-name descname"><span class="pre">pn_weight_factor</span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.pn_weight_factor" title="Link to this definition"></a></dt>
<dd><p>Weight factor applied to the pertinent negative features to emphasize their impact.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.cat_features">
<span class="sig-name descname"><span class="pre">cat_features</span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.cat_features" title="Link to this definition"></a></dt>
<dd><p>Categorical features derived from the pertinent negatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.labels">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.labels" title="Link to this definition"></a></dt>
<dd><p>Generated labels with optional noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.features" title="Link to this definition"></a></dt>
<dd><p>Name of the attribute representing the input features.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.ground_truth_attribute">
<span class="sig-name descname"><span class="pre">ground_truth_attribute</span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.ground_truth_attribute" title="Link to this definition"></a></dt>
<dd><p>Name of the attribute considered as ground truth for analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.subset_data">
<span class="sig-name descname"><span class="pre">subset_data</span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.subset_data" title="Link to this definition"></a></dt>
<dd><p>List of attributes to be included in subsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.subset_attribute">
<span class="sig-name descname"><span class="pre">subset_attribute</span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.subset_attribute" title="Link to this definition"></a></dt>
<dd><p>Additional attributes to be considered in subsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id34">
<span class="sig-name descname"><span class="pre">pn_zero_likelihood</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#id34" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id35">
<span class="sig-name descname"><span class="pre">pn_weight_factor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#id35" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id36">
<span class="sig-name descname"><span class="pre">pn_features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0]</span></em><a class="headerlink" href="#id36" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id37">
<span class="sig-name descname"><span class="pre">cat_features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0]</span></em><a class="headerlink" href="#id37" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.label_noise">
<span class="sig-name descname"><span class="pre">label_noise</span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.label_noise" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id38">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#id38" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id39">
<span class="sig-name descname"><span class="pre">features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'samples'</span></em><a class="headerlink" href="#id39" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id40">
<span class="sig-name descname"><span class="pre">ground_truth_attribute</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ground_truth'</span></em><a class="headerlink" href="#id40" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id41">
<span class="sig-name descname"><span class="pre">subset_data</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['samples',</span> <span class="pre">'weighted_samples',</span> <span class="pre">'ground_truth']</span></em><a class="headerlink" href="#id41" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id42">
<span class="sig-name descname"><span class="pre">subset_attribute</span></span><a class="headerlink" href="#id42" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset._intialize_pn_features">
<span class="sig-name descname"><span class="pre">_intialize_pn_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pn_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset._intialize_pn_features" title="Link to this definition"></a></dt>
<dd><p>Validates and initializes the indices of features to be considered as pertinent negatives (PN).</p>
<p>Ensures that specified pertinent negative features are within the valid range of feature indices.
Falls back to the first feature if pn_features is not specified or invalid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pn_features</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – Indices of features specified as pertinent negatives.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The validated list of indices for pertinent negative features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[int]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any specified pertinent negative feature index is out of the valid range or if the input is not a list.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset._initialize_zeros_for_PN">
<span class="sig-name descname"><span class="pre">_initialize_zeros_for_PN</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset._initialize_zeros_for_PN" title="Link to this definition"></a></dt>
<dd><p>Sets the values of pertinent negative (PN) features to zero with a specified likelihood,
across all samples in a vectorized manner.</p>
<p>This modification is performed directly on the <cite>samples</cite> attribute.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset._get_new_weighted_samples">
<span class="sig-name descname"><span class="pre">_get_new_weighted_samples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset._get_new_weighted_samples" title="Link to this definition"></a></dt>
<dd><p>Recalculates the weighted samples considering the introduction of zeros
for pertinent negative features in a vectorized manner.</p>
<p>Adjusts the weight of features set to zero to emphasize their impact by using the pn_weight_factor.
Updates the <cite>weighted_samples</cite> attribute with the new calculations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset._create_ground_truth_baseline">
<span class="sig-name descname"><span class="pre">_create_ground_truth_baseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset._create_ground_truth_baseline" title="Link to this definition"></a></dt>
<dd><p>Creates the ground truth baseline based on the specified baseline type (“zero” or “one”).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>baseline</strong> (<em>str</em>) – Specifies the type of baseline to use. Must be either “zero” or “one”.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If the specified baseline is not “zero” or “one”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['ground_truth_attribute',</span> <span class="pre">'baseline']</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Retrieve a sample and its associated label by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index of the sample to retrieve.</p></li>
<li><p><strong>others</strong> (<em>list</em>) – Additional items to retrieve. Defaults to [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the sample and its label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.PertinentNegativesDataset.generate_model">
<span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="headerlink" href="#datagenerator.PertinentNegativesDataset.generate_model" title="Link to this definition"></a></dt>
<dd><p>Generates and returns a neural network model tailored for analyzing the impact of pertinent negatives.</p>
<p>The model is configured to incorporate the weights, pertinent negatives,
and the pertinent negative weight factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A neural network model designed to work with the dataset’s specific configuration,</dt><dd><p>including the pertinent negatives and their associated weight factor.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../model/index.html#model.PertinentNN" title="model.PertinentNN">model.PertinentNN</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">ShatteredGradientsDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discontinuity_ratios</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_fun</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_distributions_flag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classification</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">xaiunits.datagenerator.WeightedFeaturesDataset</span></code></p>
<p>A class intended to generate data and weights that exhibit shattered gradient phenomena.</p>
<p>This class generates weights depending on the activation function and the discontinuity ratios.
The discontinuity ratio is a set of real numbers (one per feature), so small perturbations
around this discontinuity ratio significantly impact the model’s explanation.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>WeightedFeaturesDataset: Class extending BaseFeaturesDataset with support for weighted features</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset.weights">
<span class="sig-name descname"><span class="pre">weights</span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset.weights" title="Link to this definition"></a></dt>
<dd><p>Weights applied to each feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset.weight_range">
<span class="sig-name descname"><span class="pre">weight_range</span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset.weight_range" title="Link to this definition"></a></dt>
<dd><p>The range (min, max) within which random weights are generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset.weighted_samples">
<span class="sig-name descname"><span class="pre">weighted_samples</span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset.weighted_samples" title="Link to this definition"></a></dt>
<dd><p>The samples after applying weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<p>Initializes a ShatteredGradientsDataset object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Seed for reproducibility. Defaults to 0.</p></li>
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features. Defaults to 5.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples. Defaults to 100.</p></li>
<li><p><strong>discontinuity_ratios</strong> (<em>list</em><em>, </em><em>optional</em>) – Ratios indicating feature discontinuity.
If None, ratios are generated randomly. Defaults to None. Example: (1, -3, 4, 2, -2)</p></li>
<li><p><strong>bias</strong> (<em>float</em>) – Bias value. Defaults to 0.5.</p></li>
<li><p><strong>act_fun</strong> (<em>str</em>) – Activation function (“Relu”, “Gelu”, or “Sigmoid”). Defaults to “Relu”.</p></li>
<li><p><strong>two_distributions_flag</strong> (<em>bool</em>) – Flag for using two distributions. Defaults to False.</p></li>
<li><p><strong>proportion</strong> (<em>float</em>) – Proportion of samples for narrow distribution when using two distributions.
Defaults to 0.2.</p></li>
<li><p><strong>classification</strong> (<em>bool</em>) – Flag for classification. Defaults to False.</p></li>
<li><p><strong>**kwargs</strong> – <p>Arbitrary keyword arguments passed to the base class constructor, including:</p>
<ul>
<li><p>sample_std_dev_narrow (float): Standard deviation for sample creation noise in
narrow distribution. Defaults to 0.05.</p></li>
<li><p>sample_std_dev_wide (float): Standard deviation for sample creation noise in
wide distribution. Defaults to 10.</p></li>
<li><p>weight_scale (float): Scalar value to multiply all generated weights with.</p></li>
<li><p>label_std_dev (float): Noise standard deviation to generate labels. Defaults to 0.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset._initialize_with_narrow_wide_distributions">
<span class="sig-name descname"><span class="pre">_initialize_with_narrow_wide_distributions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discontinuity_ratios</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_fun</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classification</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset._initialize_with_narrow_wide_distributions" title="Link to this definition"></a></dt>
<dd><p>Initializes the dataset with narrow and wide distributions.</p>
<p>This method sets up the dataset with narrow and wide distributions. It generates
a dataset with the first portion of data belonging to the narrow distribution
dependent on sample_std_dev_narrow. Similarly, the second portion of the dataset will
belong to the wider distribution, depending on sample_std_dev_wide.</p>
<p>It also initializes the weights dependent on discontinuity ratios and weight_scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Seed for random number generation to ensure reproducibility.</p></li>
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features in the dataset.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples in the dataset.</p></li>
<li><p><strong>discontinuity_ratios</strong> (<em>list</em>) – List of discontinuity ratios for each feature.</p></li>
<li><p><strong>bias</strong> (<em>float</em>) – Bias value to adjust the weight scale.</p></li>
<li><p><strong>act_fun</strong> (<em>str</em>) – Activation function name (‘Relu’, ‘Gelu’, or ‘Sigmoid’).</p></li>
<li><p><strong>proportion</strong> (<em>float</em>) – Proportion of narrow samples to wide samples.</p></li>
<li><p><strong>classification</strong> (<em>bool</em>) – Indicates if the dataset is for classification (True) or regression (False).</p></li>
<li><p><strong>**kwargs</strong> – <p>Arbitrary keyword arguments passed to the base class constructor, including:</p>
<ul>
<li><p>sample_std_dev_narrow (float): Standard deviation for sample creation noise in
narrow distribution. Defaults to 0.05.</p></li>
<li><p>sample_std_dev_wide (float): Standard deviation for sample creation noise in
wide distribution. Defaults to 10.</p></li>
<li><p>weight_scale (float): Scalar value to multiply all generated weights with.</p></li>
<li><p>label_std_dev (float): Noise standard deviation to generate labels. Defaults to 0.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset._initialize_with_narrow_distribution">
<span class="sig-name descname"><span class="pre">_initialize_with_narrow_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discontinuity_ratios</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_fun</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classification</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset._initialize_with_narrow_distribution" title="Link to this definition"></a></dt>
<dd><p>Initializes the dataset with just a narrow distribution.</p>
<p>It generates a dataset with the first portion of data belonging
to the narrow distribution dependent on sample_std_dev_narrow.</p>
<p>It also initializes the weights dependent on discontinuity ratios and weight_scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em>) – Seed for random number generation to ensure reproducibility.</p></li>
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features in the dataset.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples in the dataset.</p></li>
<li><p><strong>discontinuity_ratios</strong> (<em>list</em>) – List of discontinuity ratios for each feature.</p></li>
<li><p><strong>bias</strong> (<em>float</em>) – Bias value to adjust the weight scale.</p></li>
<li><p><strong>act_fun</strong> (<em>str</em>) – Activation function name (‘Relu’, ‘Gelu’, or ‘Sigmoid’).</p></li>
<li><p><strong>proportion</strong> (<em>float</em>) – Proportion of narrow samples to wide samples.</p></li>
<li><p><strong>classification</strong> (<em>bool</em>) – Indicates if the dataset is for classification (True) or regression (False).</p></li>
<li><p><strong>**kwargs</strong> – <p>Arbitrary keyword arguments passed to the base class constructor, including:</p>
<ul>
<li><p>sample_std_dev_narrow (float): Standard deviation for sample creation noise in
narrow distribution. Defaults to 0.05.</p></li>
<li><p>weight_scale (float): Scalar value to multiply all generated weights with.</p></li>
<li><p>label_std_dev (float): Noise standard deviation to generate labels. Defaults to 0.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset._initialize_samples_narrow_wide">
<span class="sig-name descname"><span class="pre">_initialize_samples_narrow_wide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_narrow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.distributions.Distribution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_wide</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.distributions.Distribution</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.distributions.Distribution</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset._initialize_samples_narrow_wide" title="Link to this definition"></a></dt>
<dd><p>Initializes synthetic samples with narrow and wide distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em>) – Total number of samples to generate.</p></li>
<li><p><strong>proportion</strong> (<em>float</em>) – Proportion of samples that should belong to the narrow distribution.
It should be between 0 and 1, where 0 indicates no narrow samples, and 1 indicates all samples are narrow.</p></li>
<li><p><strong>distribution_narrow</strong> (<em>torch.distributions.Distribution</em>) – Narrow distribution object.</p></li>
<li><p><strong>distribution_wide</strong> (<em>torch.distributions.Distribution</em>) – Wide distribution object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the generated samples and the distribution used.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset._initialize_discontinuity_ratios">
<span class="sig-name descname"><span class="pre">_initialize_discontinuity_ratios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discontinuity_ratios</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset._initialize_discontinuity_ratios" title="Link to this definition"></a></dt>
<dd><p>Initialize discontinuity ratios for each feature in the dataset.</p>
<p>If <cite>discontinuity_ratios</cite> is None, this method generates initial discontinuity ratios for each feature
based on the specified <cite>n_features</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>discontinuity_ratios</strong> (<em>list</em><em> | </em><em>NoneType</em>) – List of discontinuity ratios for each feature.
If None, new discontinuity ratios will be generated.</p></li>
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features in the dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of discontinuity ratios for each feature.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If there are no positive or negative ratios, if <cite>discontinuity_ratios</cite>
is not a list, or if the length of <cite>discontinuity_ratios</cite> does not match <cite>n_features</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset._get_default_distribution_narrow">
<span class="sig-name descname"><span class="pre">_get_default_distribution_narrow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.distributions.Distribution</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset._get_default_distribution_narrow" title="Link to this definition"></a></dt>
<dd><p>Returns the default narrow distribution for the dataset.</p>
<p>This method sets the default narrow distribution based on the provided <cite>kwargs</cite> or defaults.
The sample_std_dev_narrow is used to determine the covariance matrix of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features in the dataset.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – <p>Additional keyword arguments for configuration:</p>
<ul>
<li><p>sample_std_dev_narrow (float): Used to determine the covariance
matrix of the distribution.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the default narrow distribution and the modified kwargs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset._get_default_distribution_wide">
<span class="sig-name descname"><span class="pre">_get_default_distribution_wide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.distributions.Distribution</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset._get_default_distribution_wide" title="Link to this definition"></a></dt>
<dd><p>Returns the default wide distribution for the dataset.</p>
<p>This method sets up the default wide distribution based on the provided <cite>kwargs</cite> or defaults.
The sample_std_dev_wide is used to determine the covariance matrix of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features in the dataset.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – <p>Additional keyword arguments for configuration:</p>
<ul>
<li><p>sample_std_dev_wide (float): Used to determine the covariance
matrix of the distribution.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the default wide distribution and the modified kwargs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset._default_activation_function">
<span class="sig-name descname"><span class="pre">_default_activation_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">act_fun</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classification</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset._default_activation_function" title="Link to this definition"></a></dt>
<dd><p>Returns the default activation function based on the provided function name and task type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>act_fun</strong> (<em>str</em><em> or </em><em>nn.Module</em>) – Name or instance of the activation function (‘Relu’, ‘Gelu’, ‘Sigmoid’),
or a custom activation function instance.</p></li>
<li><p><strong>classification</strong> (<em>bool</em>) – Indicates if the dataset is for classification (True) or regression (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The default activation function is based on the specified name, instance, and task type.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If the provided activation function is not one of ‘Relu’, ‘Gelu’, or ‘Sigmoid’,
and it does not match the type of a custom activation function already defined in the mapping.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset._get_weight_scale">
<span class="sig-name descname"><span class="pre">_get_weight_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_fun</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset._get_weight_scale" title="Link to this definition"></a></dt>
<dd><p>Adjust the weight scaling factor based on the activation function used.</p>
<p>This method calculates and updates the weight scaling factor in the kwargs dictionary
based on the provided activation function. A different default weight scale
is applied for’ Sigmoid’ activation than other activation functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional keyword arguments, potentially including ‘weight_scale’.
If the user does not specify weight_scale, Default is implemented.</p></li>
<li><p><strong>act_fun</strong> (<em>str</em>) – Name of the activation function (‘Relu’, ‘Gelu’, or ‘Sigmoid’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated kwargs with the ‘weight_scale’ value adjusted according to the activation function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If the activation function is not one of ‘Relu’, ‘Gelu’, or ‘Sigmoid’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset._generate_default_weights">
<span class="sig-name descname"><span class="pre">_generate_default_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_fun</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset._generate_default_weights" title="Link to this definition"></a></dt>
<dd><p>Generate default weights based on discontinuity ratios, bias, and activation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features in the dataset.</p></li>
<li><p><strong>weight_scale</strong> (<em>float</em>) – Scaling factor for weight initialization.</p></li>
<li><p><strong>act_fun</strong> (<em>str</em>) – Name of the activation function (‘Relu’, ‘Gelu’, or ‘Sigmoid’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Default weights for each feature, adjusted based on discontinuity ratios, bias, and activation function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ZeroDivisionError</strong> – If the sum of positive or negative ratios is zero, indicating a configuration issue.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset.generate_model">
<span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset.generate_model" title="Link to this definition"></a></dt>
<dd><p>Generate a model using the Shattered Gradients Neural Network architecture.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An instance of the ShatteredGradientsNN model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../model/index.html#model.ShatteredGradientsNN" title="model.ShatteredGradientsNN">model.ShatteredGradientsNN</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Retrieve a sample and its associated label by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index of the sample to retrieve.</p></li>
<li><p><strong>others</strong> (<em>list</em>) – Additional items to retrieve. Defaults to [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the sample and its label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="datagenerator.ShatteredGradientsDataset.default_metric">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#datagenerator.ShatteredGradientsDataset.default_metric" title="Link to this definition"></a></dt>
<dd><p>The default metric for evaluating the performance of explanation methods applied
to this dataset.</p>
<p>For this dataset, the default metric is the max sensitivity metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A class that wraps around the default metric to be instantiated</dt><dd><p>within the pipeline.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>type</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">UncertaintyAwareDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">xaiunits.datagenerator.BaseFeaturesDataset</span></code></p>
<p>A dataset designed to investigate how feature attribution methods treat inputs
features that equally impact model prediction.</p>
<p>In particular, uncertainty/common features are input features that contribution equally
to output class prediction. feature attribution method is expected not to assign any attribution
score to these uncertainty inputs. The last columns of the dataset are uncertainty/common features.</p>
<p>Users can also pass in their own weights if they wish to test for more complex uncertainty
behavior, e.g. uncertainty/common feature only contribution equally to a subset of output classes.</p>
<dl class="simple">
<dt>Inherits from:</dt><dd><p>BaseFeaturesDataset: Base class for generating datasets with features and labels.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.weighted_samples">
<span class="sig-name descname"><span class="pre">weighted_samples</span></span><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.weighted_samples" title="Link to this definition"></a></dt>
<dd><p>Samples multiplied by weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.weights">
<span class="sig-name descname"><span class="pre">weights</span></span><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.weights" title="Link to this definition"></a></dt>
<dd><p>Weights matrix for feature transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.labels">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.labels" title="Link to this definition"></a></dt>
<dd><p>Softmax output of weighted samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<p>Initializes an UncertaintyAwareDataset object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features in the dataset. Defaults to 5.</p></li>
<li><p><strong>weights</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Custom weights matrix for feature transformation. Defaults to None.</p></li>
<li><p><strong>common_features</strong> (<em>int</em>) – Number of uncertainty/common features present. Defaults to 1.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed for random number generation. Defaults to 0.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of samples in the dataset. Defaults to 10.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for the base class constructor.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.common_features">
<span class="sig-name descname"><span class="pre">common_features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.common_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id43">
<span class="sig-name descname"><span class="pre">weighted_samples</span></span><a class="headerlink" href="#id43" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id44">
<span class="sig-name descname"><span class="pre">weights</span></span><a class="headerlink" href="#id44" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id45">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#id45" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.mask">
<span class="sig-name descname"><span class="pre">mask</span></span><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.mask" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.features">
<span class="sig-name descname"><span class="pre">features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'samples'</span></em><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.ground_truth_attribute">
<span class="sig-name descname"><span class="pre">ground_truth_attribute</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'mask'</span></em><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.ground_truth_attribute" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.subset_data">
<span class="sig-name descname"><span class="pre">subset_data</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['samples',</span> <span class="pre">'weighted_samples',</span> <span class="pre">'mask']</span></em><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.subset_data" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.subset_attribute">
<span class="sig-name descname"><span class="pre">subset_attribute</span></span><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.subset_attribute" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset._create_weights">
<span class="sig-name descname"><span class="pre">_create_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset._create_weights" title="Link to this definition"></a></dt>
<dd><p>Creates weights matrix based on common features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_features</strong> (<em>int</em>) – Number of features in the dataset.</p></li>
<li><p><strong>weights</strong> (<em>torch.Tensor</em>) – Custom weights matrix for feature transformation.</p></li>
<li><p><strong>common_features</strong> (<em>list</em>) – List of indices representing common features.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Weights matrix for feature transformation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>weights (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['ground_truth_attribute']</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.__getitem__" title="Link to this definition"></a></dt>
<dd><p>Retrieve a sample and its associated label by index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index of the sample to retrieve.</p></li>
<li><p><strong>others</strong> (<em>list</em>) – Additional items to retrieve. Defaults to [“ground_truth_attribute”].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the sample and its label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.generate_model">
<span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">softmax_layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.Module</span></span></span><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.generate_model" title="Link to this definition"></a></dt>
<dd><p>Generates an UncertaintyNN model based on the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Instance of UncertaintyNN model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="../model/index.html#model.UncertaintyNN" title="model.UncertaintyNN">model.UncertaintyNN</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="datagenerator.UncertaintyAwareDataset.default_metric">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#datagenerator.UncertaintyAwareDataset.default_metric" title="Link to this definition"></a></dt>
<dd><p>The default metric for evaluating the performance of explanation methods applied
to this dataset.</p>
<p>For this dataset, the default metric is modified Mean Squared Error (MSE) loss function.
This metric measures the MSE for common/uncertainty features which should be 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A class that wraps around the default metric to be instantiated</dt><dd><p>within the pipeline.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>type</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datagenerator.</span></span><span class="sig-name descname"><span class="pre">TextTriggerDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sequence_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baselines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">220</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'XAIUnits/TriggerLLM_v2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#datagenerator.TextTriggerDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseTextDataset</span></code></p>
<p>A PyTorch Dataset for text data with trigger words and feature masks, designed for explainable AI (XAI) tasks.</p>
<p>This dataset loads text data, tokenizes it, identifies trigger words, and generates feature masks highlighting these words.
It’s specifically tailored for analyzing the impact of trigger words on model predictions.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.index">
<span class="sig-name descname"><span class="pre">index</span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.index" title="Link to this definition"></a></dt>
<dd><p>A tuple specifying the start and end indices for data subset selection. Defaults to None, using the entire dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.tokenizer">
<span class="sig-name descname"><span class="pre">tokenizer</span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.tokenizer" title="Link to this definition"></a></dt>
<dd><p>The tokenizer to use for text processing. If None, it’s loaded based on the specified model_name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>transformers.PreTrainedTokenizer, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.max_sequence_length">
<span class="sig-name descname"><span class="pre">max_sequence_length</span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.max_sequence_length" title="Link to this definition"></a></dt>
<dd><p>The maximum sequence length for input text. Longer sequences are truncated. Defaults to 4096.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.seed" title="Link to this definition"></a></dt>
<dd><p>Random seed for shuffling the data. Use -1 for no shuffling. Defaults to 42.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.baselines">
<span class="sig-name descname"><span class="pre">baselines</span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.baselines" title="Link to this definition"></a></dt>
<dd><p>Baseline token ID or string for attribution methods. Defaults to 220 (space token for Llama models).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.skip_tokens">
<span class="sig-name descname"><span class="pre">skip_tokens</span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.skip_tokens" title="Link to this definition"></a></dt>
<dd><p>List of tokens to skip during attribution. Defaults to an empty list.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.model_name" title="Link to this definition"></a></dt>
<dd><p>The name of the model to use for loading the tokenizer. Defaults to “XAIUnits/TriggerLLM_v2”.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id46">
<span class="sig-name descname"><span class="pre">model_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'XAIUnits/TriggerLLM_v2'</span></em><a class="headerlink" href="#id46" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.target">
<span class="sig-name descname"><span class="pre">target</span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.target" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.__getitem__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.__len__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.generate_model">
<span class="sig-name descname"><span class="pre">generate_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#datagenerator.TextTriggerDataset.generate_model" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.collate_fn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">collate_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#datagenerator.TextTriggerDataset.collate_fn" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="datagenerator.TextTriggerDataset.default_metric">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><a class="headerlink" href="#datagenerator.TextTriggerDataset.default_metric" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../common_lib/index.html" class="btn btn-neutral float-left" title="common_lib" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="backgrounds/index.html" class="btn btn-neutral float-right" title="datagenerator.backgrounds" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, XAI-Units.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>